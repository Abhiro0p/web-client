<h4>Leitindikator</h4>

<p>Mindestens zwei (Basis-)Indikator m&uuml;ssen angegeben werden, aus dem sich der Ziel-Indikator
	ableitet. Beliebig viele sind m&ouml;glich.</p>
	<p ng-bind-html="fixProcessDescription">
	</p>

<div class="row vertical-align">
	<div class="col-md-10 col-sm-12 col-xs-12">
		<!-- <div style="text-align: left;"> -->
		<div class="box box-danger collapsed-box" style="background: #ebf0fd;">
			<div class="box-header">
				<h3 class="box-title">Notwendige (Basis-)Indikatoren</h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
					</button>
				</div>
			</div>
			<!-- /.box-header -->
			<div class="box-body">

				<!-- Inputs for new reference -->

				<div class="row vertical-align">
					<div class="col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>Auswahl der f&uuml;r die Berechnung erforderlichen (Basis-)Indikatoren</label>
							<div class="input-group">
								<span class="input-group-addon"><i class="fas fa-filter"></i></span>
								<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model-options="{debounce: 500, blur: 0}"
									ng-model="indicatorNameFilter">
							</div>
							<br />
							<select ng-model="tmpIndicatorSelection" size="5"
								ng-options="indicatorMetadata as indicatorMetadata.indicatorName for indicatorMetadata in $ctrl.kommonitorDataExchangeServiceInstance.availableIndicators | filter:indicatorNameFilter"
								class="form-control">
								<option disabled selected value> -- Indikator als Berechnungsgrundlage w&auml;hlen --
								</option>
							</select>
							<div class="help-block with-errors"></div>
						</div>
					</div>
				</div>

				<div class="row vertical-align">
					<div class="col-md-3 col-sm-6 col-xs-12">
						<div class="form-group">
							<label>ID des selektierten Indikators</label>
							<input type="text" class="form-control input-sm" disabled placeholder="IndikatorenId"
								ng-model="tmpIndicatorSelection.indicatorId">
							<div class="help-block with-errors"></div>
						</div>
					</div>
					<div class="col-md-5 col-sm-6 col-xs-12">
						<div class="form-group">
							<label>Name des selektierten Indikators</label>
							<input type="text" class="form-control input-sm" disabled placeholder="IndikatorenName"
								ng-model="tmpIndicatorSelection.indicatorName">
							<div class="help-block with-errors"></div>
						</div>
					</div>
					<div class="col-md-4 col-sm-6 col-xs-12">
						<div class="form-group">
							<label>Polarit&auml;t f&uuml;r Min-Max-Normalisierung</label>
							<select ng-model="tmpIndicatorPolarity" size="5"
								ng-options="polarityOption as polarityOption.displayName for polarityOption in polarityOptions"
								class="form-control">
								<option disabled selected value> -- Polarit&auml;t f&uuml;r Min-Max-Normalisierung w&auml;hlen --
								</option>
							</select>
							<div class="help-block with-errors"></div>
						</div>
					</div>
				</div>

				<div class="row vertical-align">
					<div class="col-md-3 col-sm-6 col-xs-12">
						<div class="form-group">
							<button class="btn btn-success btn-sm" ng-disabled="!tmpIndicatorSelection"
								ng-click="addBaseIndicator(tmpIndicatorSelection)">Hinzuf&uuml;gen</button>
							<div class="help-block with-errors"></div>
						</div>
					</div>
				</div>

				<br />
				<br />

				<!-- Table to display currently specified base indicators -->
				<div class="row vertical-align">
					<div class="col-md-12 col-sm-12 col-xs-12">
						<label>&Uuml;bersicht der definierten (Basis-)Indikatoren</label>
						<table class="table table-condensed">
							<thead>
								<tr>
									<th>Editierfunktionen</th>
									<th>ID des Indikators</th>
									<th>Name des Indikators</th>
									<th>Beschreibung</th>
									<th>Einheit</th>
									<th>Polarit&auml;t Min-Max-Normalisierung</th>
								</tr>
							</thead>
							<tbody>
								<tr
									ng-repeat="baseIndicator in baseIndicators">
									<td>
										<div class="btn-group btn-group-sm">
											<button class="btn btn-danger btn-sm" type="button"
												ng-click="removeBaseIndicator(baseIndicator)"
												title="Eintrag l&ouml;schen"><i class="fas fa-trash"></i></button>
										</div>
									</td>
									<td>{{baseIndicator.indicatorId}}</td>
									<td>{{baseIndicator.indicatorName}}</td>
									<td>{{baseIndicator.metadata.description}}</td>
									<td>{{baseIndicator.unit}}</td>
									<td>{{baseIndicator.polarity.displayName}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>


			</div>
			<!-- Box Body -->
		</div>
		<!-- Box -->

		<!-- </div>	 -->

	</div>

</div>

<div class="row vertical-align">
	<div class="col-md-10 col-sm-12 col-xs-12">
		<!-- <div style="text-align: left;"> -->
		<div class="box box-danger collapsed-box" style="background: #ebf0fd;">
			<div class="box-header">
				<h3 class="box-title">Notwendiges Aggregationsverfahren zur Verkn&uuml;pfung der (Basis-)Indikatoren</h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
					</button>
				</div>
			</div>
			<!-- /.box-header -->
			<div class="box-body">

				<!-- Inputs for new reference -->

				<div class="row vertical-align">
					<div class="col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>Auswahl des f&uuml;r die Berechnung erforderlichen Aggregationsverfahrens, nach dem die gerankten und normalisierten (Basis-)Indikatoren-Werte verkn&uuml;pft werden. </label>
							<br />
							<select ng-model="aggregationOption" size="5"
								ng-options="aggregationOption as aggregationOption.displayName for aggregationOption in aggregationOptions"
								class="form-control">
								<option disabled selected value> -- Aggregationslogik w&auml;hlen --
								</option>
							</select>
							<div class="help-block with-errors"></div>
						</div>
					</div>
				</div>

			</div>
			<!-- Box Body -->
		</div>
		<!-- Box -->

		<!-- </div>	 -->

	</div>

</div>


<div class="row vertical-align">
	<div class="col-md-10 col-sm-12 col-xs-12">
		<!-- <div style="text-align: left;"> -->
		<div class="box box-danger collapsed-box" style="background: #ebf0fd;">
			<div class="box-header">
				<h3 class="box-title">Skript Code - Vorschaufenster (Summe der Indikatorenwerte)</h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
					</button>
				</div>
			</div>
			<!-- /.box-header -->
			<div class="box-body">

				<div class="row vertical-align">
					<div class="col-md-10 col-sm-10 col-xs-12">
						<p>Der Skript Code ist vordefiniert und kann nicht editiert werden. Dieses Fenster dient lediglich der Vorschau und Nachvollziehbarkeit der Berechnungsschritte.</p>
					</div>
				</div>

				<div class="row vertical-align">
					<div class="col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>Vorschaufenster des Skript-Codes*</label>
							<br/>
							<br/>
							<pre ng-show="scriptCode_readableString_forPreview" class="prettyprint linenums" style="max-height: 450px; overflow: auto; text-align: left;" id="scriptCodePreview"><code class="language-javascript" ng-bind-html="scriptCode_readableString_forPreview"></code></pre>
						</div>
					</div>
				</div>


			</div>
			<!-- Box Body -->
		</div>
		<!-- Box -->

		<!-- </div>	 -->

	</div>
</div>	

<div class="row vertical-align">
		<div class="col-md-10 col-sm-12 col-xs-12">
			<!-- <div style="text-align: left;"> -->
			<div class="box box-info collapsed-box" style="background: #ebf0fd;">
				<div class="box-header">
					<h3 class="box-title">&Uuml;berschreiben relevanter Ziel-Indikator Metadaten (Optional)</h3>
	
					<div class="box-tools pull-right">
						<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
						</button>
					</div>
				</div>
				<!-- /.box-header -->
				<div class="box-body">

					<p>KomMonitor erlaubt es, die Berechnungs-Methodik des Ziel-Indikators zu &uuml;berschreiben. 
						Das Vorschaufenster zeigt den (editierbaren) Textbaustein. Um diesen Text als "Methodik" des Ziel-Indikators zu setzen,
						aktivieren Sie bitte den entsprechenden Schalter und registrieren das Skript. 
					</p>
	
					<div class="row vertical-align">
						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="form-group">
								<label>Editierfenster des Methodik-Textbausteins (HTML)</label>
								<br/>
								<br/>
								<textarea rows="4" ng-model="$ctrl.kommonitorScriptHelperServiceInstance.scriptFormulaHTML" ></textarea>
							</div>
							<div class="help-block">
								<p>Hinweis: KomMonitor nutzt <a target="_blank" rel="noopener noreferrer" href="https://www.mathjax.org/">MathJax und Tex-Syntax</a>, um Formeln darzustellen.
									Gem&auml;&szlig; <a target="_blank" rel="noopener noreferrer" href="https://www.mathjax.org/#demo">MathJax Demo Seite</a> wird der Formel-Code von 
									 <code>$$ ... $$</code> (Anzeige in neuer Zeile) oder <code>$ ... $</code> (Inline-Anzeige) Trennzeichen umschlossen.
								</p>
							</div>
						</div>
						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="form-group">
								<label>Vorschaufenster</label>
								<br/>
								<br/>
								<p mathjax-bind="$ctrl.kommonitorScriptHelperServiceInstance.scriptFormulaHTML"></p>
							</div>
						</div>
					</div>

					<hr>
	
					<div class="row vertical-align">
						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="form-group">
								<label>Mit diesem Textbaustein das "Methodik"-Metadatum des Ziel-Indikators &uuml;berschreiben?</label>
	
								<br/>	
								<label class="switch">
									<input type="checkbox" value="$ctrl.kommonitorScriptHelperServiceInstance.scriptFormulaHTML_overwriteTargetIndicatorMethod" ng-model="$ctrl.kommonitorScriptHelperServiceInstance.scriptFormulaHTML_overwriteTargetIndicatorMethod">
									<span class="switchslider round"></span>
								</label>
							</div>
						</div>
						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="form-group">
								<label>Derzeitiger Eintrag zum Vergleich</label>
								<br/>
								<br/>
								<p mathjax-bind="$ctrl.kommonitorScriptHelperServiceInstance.targetIndicator.processDescription"></p>
							</div>
						</div>
					</div>		
	
				</div>
				<!-- Box Body -->
			</div>
			<!-- Box -->
	
			<!-- </div>	 -->
	
		</div>

</div>