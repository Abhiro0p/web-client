<div>
	<h3 class="justify" align="center">Interaktive parametrisierte Neuberechnung eines Indikators</h3>
	<div ng-if="!$ctrl.targetIndicator">
		<p>Bitte erst einen Indikator ausw&auml;hlen, der über ein Skript berechnet werden kann.</p>
	</div>

	<div>
		<select
			ng-model="$ctrl.targetIndicator" ng-options="indicator as indicator.indicatorName for indicator in $ctrl.wpsPropertiesServiceInstance.availableIndicators | filter:{creationType:'COMPUTATION'}"
			class="form-control" ng-change="$ctrl.onChangeTargetIndicator()" required>
			<option value="" selected disabled>Indikator w&auml;hlen</option>
			<option
				ng-repeat="indicator in $ctrl.wpsPropertiesServiceInstance.availableIndicators | filter:{creationType:'COMPUTATION'}"></option>
		</select>
	</div>

	<br />

	<div ng-if="$ctrl.targetIndicator">
		<label>Zeitschnitt w&auml;hlen</label>
		<input type="date" name="date" min="2009-01-01" max="2018-10-01" value="2015-01-01" ng-model="$ctrl.targetDate" ng-init="$ctrl.targetDate = '2015-01-01'" ng-change="$ctrl.onTargetDateChange()"/>
	</div>


	<div class="form-group" ng-if="$ctrl.targetIndicator">
		<label for="sel1">Raumebene w&auml;hlen</label>

		<!-- simple list of available processes -->
		<select
			ng-model="$ctrl.targetSpatialUnit" ng-options="spatialUnit as spatialUnit.spatialUnitLevel for spatialUnit in $ctrl.wpsPropertiesServiceInstance.availableSpatialUnits"
			ng-change="$ctrl.onChangeTargetSpatialUnit()" class="form-control" required>
			<option value="" selected disabled>Raumeinheit w&auml;hlen</option>
			<option
				ng-repeat="spatialUnit in $ctrl.wpsPropertiesServiceInstance.availableSpatialUnits"></option>
		</select>
	</div>


	<div ng-show="$ctrl.targetIndicator && $ctrl.targetSpatialUnit && $ctrl.targetDate" id="parameterManagement" align="center">

		<div class="loading-overlay ng-hide" ng-show="loadingData">
        	<span class="glyphicon glyphicon-refresh icon-spin"></span>
    	</div>

		<div>
			<label align='left'>gew&auml;hlter Indikator:</label>
			<p>{{$ctrl.targetIndicator.indicatorName}}</p>
			<p>{{$ctrl.targetIndicator.processDescription}}</p>
		</div>

		<p></p>

		<div class="form-group">
			<label align='left'>parametrisierte Neuberechung</label>
			<p>Indikator mit anderen Parametern neu berechnen</p>

				<div id="processInputForm">
					<!-- here the content is filled programatically -->
				</div>

			  <button ng-click="$ctrl.calculateCustomIndicator()" class="btn btn-primary">individuelle Neuberechnung starten</button>

			<br/>
			<p></p>
			<p>Laufzeit beträgt je nach Komplexität der Berechnung wenige Sekunden bis zu einigen Minuten!</p>

			<div ng-show="jobInfoText || computedCustomizedIndicatorGeoJSON" class="progress">
			  <div id="customComputationProgressBar" class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">
			    <!-- <span class="sr-only">{{progress}}% Fortschritt</span> -->
					0% Fortschritt
			  </div>
			</div>

			<div ng-show="jobInfoText" class="alert alert-info">
				<p>{{jobInfoText}}</p>
			</div>


			<div align="center" ng-show="computedCustomizedIndicatorGeoJSON" class="alert alert-success">

				<br/>

				<p>Berechnung erfolgreich abgeschlossen. Das Ergebnis kann entweder auf der Karte dargestellt werden oder als GeoJSON-Datei heruntergeladen werden.</p>

				<br/>
				<div style="display: inline-block" align="center" id="indicatorOutput">
					<button ng-click="$ctrl.addComputedIndicatorToMap()" type="button" class="btn btn-success">auf Karte darstellen</button>
					<!-- another button to download as GeoJSOn will be set programatically within component file -->
				</div>

			</div>

		</div>

		<div ng-show="error"
			class="alert alert-danger">
			<strong>Fehler</strong>
			Bei der Verarbeitung ist ein Fehler aufgetreten.
			<p></p>
			<p>
				<strong>Fehlernachricht: </strong>{{error}}
			</p>
		</div>

		<!-- div for describeProcess failed messages! -->
		<div
			class="alert alert-danger {{$ctrl.wpsFormControlServiceInstance.describeProcessFailed_classAttribute}}">
			<strong>{{'wpsProcesses.describeProcessFailed_short' | translate}}!</strong>
			{{'wpsProcesses.describeProcessFailed_text' | translate}}
			<p></p>
			<p>
				<strong>{{'wpsProcesses.describeProcessFailed_errorThrown' |
					translate}}</strong>{{$ctrl.wpsFormControlServiceInstance.describeProcessFailed_errorThrown}}
			</p>
		</div>

		<!-- div for capabilities success messages! -->
		<div
			class="alert alert-success {{$ctrl.wpsFormControlServiceInstance.describeProcessSuccess_classAttribute}}">
			<strong>{{'wpsProcesses.describeProcessSuccess_short' |
				translate}}!</strong> {{'wpsProcesses.describeProcessSuccess_text' | translate}}
		</div>

	</div>


</div>
