<div id="poi">

	<div align="center">
		<div class="loading-overlay-sidebar-small ng-hide" ng-show="loadingData">
					<span class="glyphicon glyphicon-refresh icon-spin"></span>
		</div>
	</div>

	<p></p>

	<div class="box box-primary">
		<div class="box-header with-border">
			<h3 class="box-title">Georessourcenauswahl</h3>

			<div class="box-tools pull-right">
				<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
				</button>
			</div>
		</div>
		<div class="box-body">

			<div align="center">
		
				<b title="Checkbox zur Wahl, ob die einzelnen Punkte eines POI Layers geclustered werden sollen">Points of Interest clustern</b> (Zusammenfassung mehrerer Punkte je nach Zoomstufe)
				&nbsp;
				<label class="switch">
					<input type="checkbox" value="useCluster" ng-model="useCluster" ng-change="refreshPoiLayers()" checked>
					<span class="switchslider round"></span>
				</label>

				<label>Art der Datumsdefinition zum Abruf eines Datensatzes</label>
				<div class="form-group">
					<label class="radio-inline"><input type="radio" name="dateSelectionType"  ng-value="dateSelectionType_valueIndicator" ng-model="dateSelectionType.selectedDateType">Datum des aktuellen Indikators</label>
					<label class="radio-inline"><input type="radio" name="dateSelectionType"  ng-value="dateSelectionType_valueManual" ng-model="dateSelectionType.selectedDateType">manuelles Datum
						<div class="input-group date">
							<div class="input-group-addon">
								<i class="far fa-calendar-alt"></i>
							</div>
							<input type="text" ng-model="selectedDate_manual" ng-disabled="!(dateSelectionType.selectedDateType === dateSelectionType_valueManual)"
								class="form-control pull-right" placeholder="YYYY-MM-DD"
								id="manualDateDatepicker" required>
						</div>
					</label>
					<label class="radio-inline"><input type="radio" name="dateSelectionType"  ng-value="dateSelectionType_valuePerDataset" ng-model="dateSelectionType.selectedDateType">pro Datensatz</label>
				</div>

			</div>

			<br/>

			<uib-tabset active="activeJustified" justified="true">
				<uib-tab index="0" heading="Datenkatalog">
		
						<div class="just-padding">

							<!-- <label>Filtern nach Typ</label>
							<br/> -->

							<!-- <div class="btn-group btn-group-justified"> -->
								<table class="table" style="width:100%;">
									<tr>
										<th colspan="3" class="text-center"><b>Infrastruktur</b></th>
										<th colspan="2" class="text-center"><b>Geodaten-Dienste</b></th>
									  </tr>
									<tr>
									  <th class="text-center"><b>Punktdaten</b></th>
									  <th class="text-center"><b>Liniendaten</b></th>
									  <th class="text-center"><b>Fl&auml;chendaten</b></th>
									  <th class="text-center"><b>WMS-Daten</b></th>
									  <th class="text-center"><b>WFS-Daten</b></th>
									</tr>
									<tr>
										<td class="text-center">
											<label class="switch">
												<input type="checkbox" ng-model="showPOI" checked>
												<span class="switchslider round"></span>
											</label>
										</td>
										<td class="text-center">
											<label class="switch">
												<input type="checkbox" ng-model="showLOI" checked>
												<span class="switchslider round"></span>
											</label>
										</td>
										<td class="text-center">
											<label class="switch">
												<input type="checkbox" ng-model="showAOI" checked>
												<span class="switchslider round"></span>
											</label>
										</td>
										<td class="text-center">
											<label class="switch">
												<input type="checkbox" ng-model="showWMS" ng-change="onChangeShowWMS()" checked>
												<span class="switchslider round"></span>
											</label>
										</td>
										<td class="text-center">
											<label class="switch">
												<input type="checkbox" ng-model="showWFS" checked>
												<span class="switchslider round"></span>
											</label>
										</td>
									</tr>
								  </table>
							<!-- </div> -->

							<div class="input-group">
								<span class="input-group-addon"><i class="fas fa-filter"></i></span>
								<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="georesourceNameFilter.value">
							</div>

							<br/>
		
							<div id="georesourceHierarchySelection" class="list-group list-group-root well">
		
								<div ng-repeat="mainTopic in $ctrl.kommonitorDataExchangeServiceInstance.availableTopics | filter:{topicType:'main'} | filter:{topicResource:'georesource'}">
									<div  class="list-group-item list-group-item-default" style="background: #2171b5; color: white;">
										<a id="{{mainTopic.topicId}}" href="" ng-attr-title="{{mainTopic.topicDescription}}" class="collapseTrigger" style="color: white;" ng-click="isCollapsed_mainTopic = !isCollapsed_mainTopic" ng-init="isCollapsed_mainTopic=true"><i class="glyphicon glyphicon-chevron-right"></i>{{mainTopic.topicName}} ({{$ctrl.kommonitorDataExchangeServiceInstance.getNumberOfGeoresources(mainTopic, georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)}})</a></a>
										&nbsp;&nbsp; <input type="checkbox" ng-model="mainTopic.isSelected" value="mainTopic.isSelected" id="showAllForTopic_{{mainTopic.topicId}}" ng-change="handleShowAllOnTopic(mainTopic)">
									</div>
		
		
									<div ng-repeat="subTopic in mainTopic.subTopics" class="list-group collapse" uib-collapse="isCollapsed_mainTopic">
		
										<div  class="list-group-item list-group-item-default" style="background: #6baed6; color: white;">
											<a id="{{subTopic.topicId}}" class="collapseTrigger" style="color: white;" ng-attr-title="{{subTopic.topicDescription}}" href="" ng-click="isCollapsed_subTopic = !isCollapsed_subTopic" ng-init="isCollapsed_subTopic=true"><i class="glyphicon glyphicon-chevron-right"></i>{{subTopic.topicName}} ({{$ctrl.kommonitorDataExchangeServiceInstance.getNumberOfGeoresources(subTopic, georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)}})</a>
											&nbsp;&nbsp; <input type="checkbox" ng-model="subTopic.isSelected" value="subTopic.isSelected" id="showAllForTopic_{{subTopic.topicId}}" ng-change="handleShowAllOnTopic(subTopic)">
										</div>
		
										<div ng-repeat="subsubTopic in subTopic.subTopics" class="list-group collapse" uib-collapse="isCollapsed_subTopic">
		
											<div  class="list-group-item list-group-item-default" style="background: #bdd7e7; color: white;">
												<a id="{{subsubTopic.topicId}}" class="collapseTrigger" style="color: white;" ng-attr-title="{{subsubTopic.topicDescription}}" href="" ng-click="isCollapsed_subsubTopic = !isCollapsed_subsubTopic" ng-init="isCollapsed_subsubTopic=true"><i class="glyphicon glyphicon-chevron-right"></i>{{subsubTopic.topicName}} ({{$ctrl.kommonitorDataExchangeServiceInstance.getNumberOfGeoresources(subsubTopic, georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)}})</a>
												&nbsp;&nbsp; <input type="checkbox" ng-model="subsubTopic.isSelected" value="subsubTopic.isSelected" id="showAllForTopic_{{subsubTopic.topicId}}" ng-change="handleShowAllOnTopic(subsubTopic)">
											</div>
		
											<div ng-repeat="subsubsubTopic in subsubTopic.subTopics" class="list-group collapse" uib-collapse="isCollapsed_subsubTopic">
		
												<div  class="list-group-item list-group-item-default" style="background: #eff3ff; color: white;">
													<a id="{{subsubsubTopic.topicId}}" class="collapseTrigger" style="color: white;" ng-attr-title="{{subsubsubTopic.topicDescription}}">{{subsubsubTopic.topicName}} ({{$ctrl.kommonitorDataExchangeServiceInstance.getNumberOfGeoresources(subsubsubTopic, georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)}})</a>
													&nbsp;&nbsp; <input type="checkbox" ng-model="subsubsubTopic.isSelected" value="subsubsubTopic.isSelected" id="showAllForTopic_{{subsubsubTopic.topicId}}" ng-change="handleShowAllOnTopic(subsubsubTopic)">
												</div>
		
											</div>
											<!-- end sub sub sub topics -->
		
		
											<div ng-show="(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
												<div class="list-group collapse" uib-collapse="isCollapsed_subsubTopic">
													<div class="list-group-item list-group-item-default georesourceInputForm">

														 <table class="table table-condensed " style="margin-bottom:0px;">
															<thead>
															  <tr>
																 <th>Typ</th> 
																<th>Datensatz</th>
																<th>Beschreibung</th>
																<th>Layer Transparenz</th>
																<th>Legende</th>
																<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
																<th>Export</th>
															  </tr>
															</thead>

															<tbody>

																<!-- POIs -->
																<tr ng-if="showPOI" ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois() | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value '>
																	<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																	<td>
																		<i class="fas fa-map-marker-alt"></i>
																	</td>
																	<td>
																		<label class='checkbox-inline' ><input type="checkbox" value="poi.datasetName" ng-model="poi.isSelected" ng-change="handlePoiOnMap(poi)">											
								
																			<b>&nbsp;&nbsp;{{poi.datasetName}}</b>
																		</label>
																	</td>
																	<td>
																		<p>{{poi.metadata.description}}</p>
																	</td>
																	<td>
																		<div class="form-group" align="center">


																			<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustPOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																			<br/>

																			<label>{{dataset.transparency}}</label>
																		</div>
																	</td>
																	<td class="text-center">
																		<div align="center">
																			<div class="awesome-marker-legend awesome-marker-legend-icon-{{poi.poiMarkerColor}}">
																				<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{poi.poiSymbolColor}};" class="glyphicon glyphicon-{{poi.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																			</div>
																		</div>																		
																	</td>
																	<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																		<select style="font-size: 11px; width:135px; padding: 0px;"
																				ng-model="poi.selectedDate" ng-change="onChangeSelectedDate(poi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																				class="form-control" required>
																			</select>
																	</td>
																	<td class="text-center">
																		<a href="" ng-click="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																		<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																	</td>
																</tr>

																<!-- LOIs -->
																<tr ng-if="showLOI" ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isLOI:true} | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value'>
																	<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																	<td>
																		<i class="fas fa-minus"></i>
																	</td>
																	<td>
																		<label class='checkbox-inline' ><input type="checkbox" value="loi.datasetName" ng-model="loi.isSelected" ng-change="handleLoiOnMap(loi)">												
							
																			<b>&nbsp;&nbsp;{{loi.datasetName}}</b>
																		</label>
																	</td>
																	<td>
																		<p>{{loi.metadata.description}}</p>
																	</td>
																	<td>
																		<div class="form-group" align="center">


																			<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustLOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																			<br/>

																			<label>{{dataset.transparency}}</label>
																		</div>
																	</td>
																	<td class="text-center">
																		<div align="center">
																			<i style="width:15px; height:15px; background:{{loi.loiColor}}; display:inherit;">
																			</i>
																		</div>
																		
																	</td>
																	<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																		<select style="font-size: 11px; width:135px; padding: 0px;"
																				ng-model="loi.selectedDate" ng-change="onChangeSelectedDate(loi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																				class="form-control" required>
																			</select>
																	</td>
																	<td class="text-center">
																		<a href="" ng-click="getExportLinkForLoi(loi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																		<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																	</td>
																</tr>

																<!-- AOIs -->
																<tr ng-if="showAOI" ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isAOI:true} | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value'>
																	<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																	<td>
																		<i class="far fa-square"></i>
																	</td>
																	<td>
																		<label class='checkbox-inline' ><input type="checkbox" value="aoi.datasetName" ng-model="aoi.isSelected" ng-change="handleAoiOnMap(aoi)">													
						
																			<b>&nbsp;&nbsp;{{aoi.datasetName}}</b> 
																		</label>
																	</td>
																	<td>
																		<p>{{aoi.metadata.description}}</p>
																	</td>
																	<td>
																		<div class="form-group" align="center">
		
																			<input class=" input-sm" ng-model="aoi.transparency" ng-init="aoi.transparency=0.3" ng-change="adjustAOILayerTransparency(aoi)" type="range"  min="0" max="1" step="0.01">
		
																			<br/>
		
																			<label>{{aoi.transparency}}</label>
																		</div>
																	</td>
																	<td class="text-center">
																		<div align="center">
																			<i style="width:15px; height:15px; background:{{aoi.aoiColor}}; display:inherit;">
																			</i>
																		</div>
																	</td>
																	<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																		<select style="font-size: 11px; width:135px; padding: 0px;"
																				ng-model="aoi.selectedDate" ng-change="onChangeSelectedDate(aoi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																				class="form-control" required>
																			</select>
																	</td>
																	<td class="text-center">
																		<a href="" ng-click="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																		<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																	</td>
																</tr>

																<!-- WMS -->
																<tr ng-if="showWMS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value | orderBy:"title"'>
																	<td>
																		<b><i>WMS</i></b>
																	</td>
																	<td>
																		<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWmsOnMap(dataset)">
		
																			<b ng-bind-html="dataset.title"></b>
																		</label>
																	</td>
																	<td>
																		<p ng-bind-html="dataset.description"></p>
																	</td>
																	<td>
																		<div class="form-group" align="center">
		
																			<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWMSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">
		
																			<br/>
		
																			<label>{{dataset.transparency}}</label>
																		</div>
																	</td>																	
																	<td  class="text-center">
																		<div ng-if="! dataset.showLegend">
																			<button class="btn btn-sm btn-primary" ng-click="dataset.showLegend = true;">laden</button>
																		</div>
																		<div ng-if="dataset.showLegend">
																			<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
																		</div>
																	</td>
																	<td>
																		-
																	</td>
																	<td class="text-center">
																		<div align="center">
																		<a href="{{dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0" title="WMS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																		</div>
																	</td>
																</tr>

																<!-- WFS -->
																<tr ng-if="showWFS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value  | orderBy:"title"'>
																	<td>
																		<b><i>WFS</i></b>
																	</td>
																	<td>
																		<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWfsOnMap(dataset)">

																			<b ng-bind-html="dataset.title"></b>
																		</label>
																	</td>
																	<td>
																		<p ng-bind-html="dataset.description"></p>
																	</td>
																	<td>
																		<div class="form-group" align="center">


																			<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWFSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																			<br/>

																			<label>{{dataset.transparency}}</label>
																		</div>
																	</td>
																	<!-- <td>
																		<label class="switch">
																			<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																		  <span class="switchslider round"></span>
																		</label>
																	</td> -->
																	
																	<td class="text-center">
																		<div ng-show="dataset.geometryType==='AOI'">
																			<div class="input-group colorpicker-component">
																				<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.aoiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																				<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																			</div>
																		</div>
																		<div ng-show="dataset.geometryType==='LOI'">
																			<div class="input-group colorpicker-component">
																				<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.loiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																				<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																			</div>
																		</div>
																		<div ng-show="dataset.geometryType==='POI'">
																			<div align="center">
																				<div class="awesome-marker-legend awesome-marker-legend-icon-{{dataset.poiMarkerColor}}">
																					<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{dataset.poiSymbolColor}};" class="glyphicon glyphicon-{{dataset.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																				</div>
																			</div>	
																		</div>
																	</td>
																	<td>
																		-
																	</td>
																	<td class="text-center">
																		<div align="center">
																		<a href="{{dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0" title="WFS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																		</div>
																	</td>
																</tr>

															</tbody>

														 </table>	
													
														</div>
												</div>
											</div>
											<div ng-show="!(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subsubTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
												<div class="list-group collapse" uib-collapse="isCollapsed_subsubTopic">
													<!-- <div class="list-group-item list-group-item-default" style="background: #eb9c98;">
														 <p><i class="fas fa-ban"></i> &nbsp;&nbsp;- keine Georessourcen in dieser Hierarchieebene -</p>
													</div> -->
												</div>
											</div>
		
		
										</div>
										<!-- end sub sub opics -->
		
		
		
										<div ng-show="(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
											<div class="list-group collapse" uib-collapse="isCollapsed_subTopic">
												<div class="list-group-item list-group-item-default georesourceInputForm">
												
													<table class="table table-condensed " style="margin-bottom:0px;">
														<thead>
														  <tr>
															 <th>Typ</th> 
															<th>Datensatz</th>
															<th>Beschreibung</th>
															<th>Layer Transparenz</th>
															<th>Legende</th>
															<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
															<th>Export</th>
														  </tr>
														</thead>

														<tbody>

															<!-- POIs -->
															<tr ng-if="showPOI" ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois() | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value'>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="fas fa-map-marker-alt"></i>
																</td>
																<td>
																	<label class='checkbox-inline' ><input type="checkbox" value="poi.datasetName" ng-model="poi.isSelected" ng-change="handlePoiOnMap(poi)">											
							
																		<b>&nbsp;&nbsp;{{poi.datasetName}}</b>
																	</label>
																</td>
																<td>
																	<p>{{poi.metadata.description}}</p>
																</td>
																<td>
																	<div class="form-group" align="center">


																		<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustPOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																		<br/>

																		<label>{{dataset.transparency}}</label>
																	</div>
																</td>
																<td  class="text-center">
																	<div align="center">
																		<div class="awesome-marker-legend awesome-marker-legend-icon-{{poi.poiMarkerColor}}">
																			<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{poi.poiSymbolColor}};" class="glyphicon glyphicon-{{poi.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																		</div>
																	</div>	
																</td>
																<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	<select style="font-size: 11px; width:135px; padding: 0px;"
																			ng-model="poi.selectedDate" ng-change="onChangeSelectedDate(poi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																			class="form-control" required>
																		</select>
																</td>
																<td class="text-center">
																	<a href="" ng-click="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																	<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																</td>
															</tr>

															<!-- LOIs -->
															<tr ng-if="showLOI" ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isLOI:true} | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value'>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="fas fa-minus"></i>
																</td>
																<td>
																	<label class='checkbox-inline' ><input type="checkbox" value="loi.datasetName" ng-model="loi.isSelected" ng-change="handleLoiOnMap(loi)">												
						
																		<b>&nbsp;&nbsp;{{loi.datasetName}}</b>
																	</label>
																</td>
																<td>
																	<p>{{loi.metadata.description}}</p>
																</td>
																<td>
																	<div class="form-group" align="center">


																		<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustLOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																		<br/>

																		<label>{{dataset.transparency}}</label>
																	</div>
																</td>
																<td class="text-center">
																	<div align="center">
																		<i style="width:15px; height:15px; background:{{loi.loiColor}}; display:inherit;">
																		</i>
																	</div>
																</td>
																<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	<select style="font-size: 11px; width:135px; padding: 0px;"
																			ng-model="loi.selectedDate" ng-change="onChangeSelectedDate(loi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																			class="form-control" required>
																		</select>
																</td>
																<td class="text-center">
																	<a href="" ng-click="getExportLinkForLoi(loi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																	<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																</td>
															</tr>

															<!-- AOIs -->
															<tr ng-if="showAOI" ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isAOI:true} | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value'>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="far fa-square"></i>
																</td>
																<td>
																	<label class='checkbox-inline' ><input type="checkbox" value="aoi.datasetName" ng-model="aoi.isSelected" ng-change="handleAoiOnMap(aoi)">													
					
																		<b>&nbsp;&nbsp;{{aoi.datasetName}}</b> 
																	</label>
																</td>
																<td>
																	<p>{{aoi.metadata.description}}</p>
																</td>
																<td>
																	<div class="form-group" align="center">
	
																		<input class=" input-sm" ng-model="aoi.transparency" ng-init="aoi.transparency=0.3" ng-change="adjustAOILayerTransparency(aoi)" type="range"  min="0" max="1" step="0.01">
	
																		<br/>
	
																		<label>{{aoi.transparency}}</label>
																	</div>
																</td>
																<td class="text-center">
																	<div align="center">
																		<i style="width:15px; height:15px; background:{{aoi.aoiColor}}; display:inherit;">
																		</i>
																	</div>
																</td>
																<td>
																	<select style="font-size: 11px; width:135px; padding: 0px;"
																			ng-model="aoi.selectedDate" ng-change="onChangeSelectedDate(aoi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																			class="form-control" required>
																		</select>
																</td>
																<td class="text-center">
																	<a href="" ng-click="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																	<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
																</td>
															</tr>

															<!-- WMS -->
															<tr ng-if="showWMS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value | orderBy:"title"'>
																<td>
																	<b><i>WMS</i></b>
																</td>
																<td>
																	<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWmsOnMap(dataset)">
	
																		<b ng-bind-html="dataset.title"></b>
																	</label>
																</td>
																<td>
																	<p ng-bind-html="dataset.description"></p>
																</td>
																<td>
																	<div class="form-group" align="center">
	
																		<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWMSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">
	
																		<br/>
	
																		<label>{{dataset.transparency}}</label>
																	</div>
																</td>
																
																<td class="text-center">
																	<div ng-if="! dataset.showLegend">
																		<button class="btn btn-sm btn-primary" ng-click="dataset.showLegend = true;">laden</button>
																	</div>
																	<div ng-if="dataset.showLegend">
																		<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
																	</div>
																</td>
																<td>
																	-
																</td>
																<td class="text-center">
																	<div align="center">
																	<a href="{{dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0" title="WMS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																	</div>
																</td>
															</tr>

															<!-- WFS -->
															<tr ng-if="showWFS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value  | orderBy:"title"'>
																<td>
																	<b><i>WFS</i></b>
																</td>
																<td>
																	<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWfsOnMap(dataset)">

																		<b ng-bind-html="dataset.title"></b>
																	</label>
																</td>
																<td>
																	<p ng-bind-html="dataset.description"></p>
																</td>
																<td>
																	<div class="form-group" align="center">

																		<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWFSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																		<br/>

																		<label>{{dataset.transparency}}</label>
																	</div>
																</td>
																<!-- <td>
																	<label class="switch">
																		<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																	  <span class="switchslider round"></span>
																	</label>
																</td> -->
																
																<td class="text-center">
																	<div>
																		<div ng-show="dataset.geometryType==='AOI'">
																			<div class="input-group colorpicker-component">
																				<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.aoiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																				<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																			</div>
																		</div>
																		<div ng-show="dataset.geometryType==='LOI'">
																			<div class="input-group colorpicker-component">
																				<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.loiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																				<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																			</div>
																		</div>
																		<div ng-show="dataset.geometryType==='POI'">
																			<div align="center">
																				<div class="awesome-marker-legend awesome-marker-legend-icon-{{dataset.poiMarkerColor}}">
																					<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{dataset.poiSymbolColor}};" class="glyphicon glyphicon-{{dataset.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																				</div>
																			</div>	
																		</div>	
																	</div>
																</td>
																<td>
																	-
																</td>
																<td class="text-center">
																	<div align="center">
																	<a href="{{dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0" title="WFS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																	</div>
																</td>
															</tr>

														</tbody>

													 </table>		
												
												</div>
											</div>
										</div>
										<div ng-show="!(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:subTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
											<div class="list-group collapse" uib-collapse="isCollapsed_subTopic">
												<!-- <div class="list-group-item list-group-item-default" style="background: #eb9c98;">
													 <p><i class="fas fa-ban"></i> &nbsp;&nbsp;- keine Georessourcen in dieser Hierarchieebene -</p>
												</div> -->
											</div>
										</div>
		
		
		
		
									</div>
									<!-- end sub topics -->
									<div ng-show="(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
										<div class="list-group collapse" uib-collapse="isCollapsed_mainTopic">
											<div class="list-group-item list-group-item-default georesourceInputForm">
												 
												<table class="table table-condensed " style="margin-bottom:0px;">
													<thead>
													  <tr>
														 <th>Typ</th> 
														<th>Datensatz</th>
														<th>Beschreibung</th>
														<th>Layer Transparenz</th>
														<th>Legende</th>
														<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
														<th>Export</th>
													  </tr>
													</thead>

													<tbody>

														<!-- POIs -->
														<tr ng-if="showPOI" ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois() | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="fas fa-map-marker-alt"></i>
															</td>
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="poi.datasetName" ng-model="poi.isSelected" ng-change="handlePoiOnMap(poi)">											
						
																	<b>&nbsp;&nbsp;{{poi.datasetName}}</b>
																</label>
															</td>
															<td>
																<p>{{poi.metadata.description}}</p>
															</td>
															<td>
																<div class="form-group" align="center">


																	<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustPOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{dataset.transparency}}</label>
																</div>
															</td>
															<td class="text-center">
																<div align="center">
																	<div class="awesome-marker-legend awesome-marker-legend-icon-{{poi.poiMarkerColor}}">
																		<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{poi.poiSymbolColor}};" class="glyphicon glyphicon-{{poi.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																	</div>
																</div>	
															</td>
															<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="poi.selectedDate" ng-change="onChangeSelectedDate(poi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
															</td>
															<td class="text-center">
																<a href="" ng-click="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
															</td>
														</tr>

														<!-- LOIs -->
														<tr ng-if="showLOI" ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isLOI:true} | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="fas fa-minus"></i>
															</td>
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="loi.datasetName" ng-model="loi.isSelected" ng-change="handleLoiOnMap(loi)">												
					
																	<b>&nbsp;&nbsp;{{loi.datasetName}}</b>
																</label>
															</td>															
															<td>
																<p>{{loi.metadata.description}}</p>
															</td>
															<td>
																<div class="form-group" align="center">


																	<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustLOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{dataset.transparency}}</label>
																</div>
															</td>
															<td class="text-center">
																<div align="center">
																	<i style="width:15px; height:15px; background:{{loi.loiColor}}; display:inherit;">
																	</i>
																</div>
															</td>
															<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="loi.selectedDate" ng-change="onChangeSelectedDate(loi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
															</td>
															<td class="text-center">
																<a href="" ng-click="getExportLinkForLoi(loi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
															</td>
														</tr>

														<!-- AOIs -->
														<tr ng-if="showAOI" ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isAOI:true} | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="far fa-square"></i>
															</td>
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="aoi.datasetName" ng-model="aoi.isSelected" ng-change="handleAoiOnMap(aoi)">													
				
																	<b>&nbsp;&nbsp;{{aoi.datasetName}}</b> 
																</label>
															</td>
															<td>
																<p>{{aoi.metadata.description}}</p>
															</td>
															<td>
																<div class="form-group" align="center">

																	<input class=" input-sm" ng-model="aoi.transparency" ng-init="aoi.transparency=0.3" ng-change="adjustAOILayerTransparency(aoi)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{aoi.transparency}}</label>
																</div>
															</td>
															<td class="text-center">
																<div align="center">
																	<i style="width:15px; height:15px; background:{{aoi.aoiColor}}; display:inherit;">
																	</i>
																</div>
															</td>
															<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="aoi.selectedDate" ng-change="onChangeSelectedDate(aoi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
															</td>
															<td class="text-center">
																<a href="" ng-click="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
																<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
															</td>
														</tr>

														<!-- WMS -->
														<tr ng-if="showWMS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value | orderBy:"title"'>
															<td>
																<b><i>WMS</i></b>
															</td>
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWmsOnMap(dataset)">

																	<b ng-bind-html="dataset.title"></b>
																</label>
															</td>
															<td>
																<p ng-bind-html="dataset.description"></p>
															</td>
															<td>
																<div class="form-group" align="center">

																	<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWMSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{dataset.transparency}}</label>
																</div>
															</td>
															
															<td class="text-center">
																<div ng-if="! dataset.showLegend">
																	<button class="btn btn-sm btn-primary" ng-click="dataset.showLegend = true;">laden</button>
																</div>
																<div ng-if="dataset.showLegend">
																	<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
																</div>
															</td>
															<td>
																-
															</td>
															<td class="text-center">
																<div align="center">
																<a href="{{dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0" title="WMS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																</div>
															</td>
														</tr>

														<!-- WFS -->
														<tr ng-if="showWFS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value  | orderBy:"title"'>
															<td>
																<b><i>WFS</i></b>
															</td>
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWfsOnMap(dataset)">

																	<b ng-bind-html="dataset.title"></b>
																</label>
															</td>
															<td>
																<p ng-bind-html="dataset.description"></p>
															</td>
															<td>
																<div class="form-group" align="center">

																	<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWFSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{dataset.transparency}}</label>
																</div>
															</td>
															<!-- <td>
																<label class="switch">
																	<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																  <span class="switchslider round"></span>
																</label>
															</td> -->
															
															<td class="text-center">
																<div>
																	<div ng-show="dataset.geometryType==='AOI'">
																		<div class="input-group colorpicker-component">
																			<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.aoiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																			<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																		</div>
																	</div>
																	<div ng-show="dataset.geometryType==='LOI'">
																		<div class="input-group colorpicker-component">
																			<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.loiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																			<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																		</div>
																	</div>
																	<div ng-show="dataset.geometryType==='POI'">
																		<div align="center">
																			<div class="awesome-marker-legend awesome-marker-legend-icon-{{dataset.poiMarkerColor}}">
																				<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{dataset.poiSymbolColor}};" class="glyphicon glyphicon-{{dataset.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																			</div>
																		</div>	
																	</div>	
																</div>
															</td>
															<td>
																-
															</td>
															<td class="text-center">
																<div align="center">
																<a href="{{dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0" title="WFS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																</div>
															</td>
														</tr>

													</tbody>

												 </table>	
										
											</div>
										</div>
									</div>
									<div ng-show="!(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0) && !(($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:{topicReference:mainTopic.topicId} | filter:georesourceNameFilter.value).length > 0)">
										<div class="list-group collapse" uib-collapse="isCollapsed_mainTopic">
											<!-- <div class="list-group-item list-group-item-default" style="background: #eb9c98;">
												 <p><i class="fas fa-ban"></i> &nbsp;&nbsp;- keine Georessourcen in dieser Hierarchieebene -</p>
											</div> -->
										</div>
									</div>
		
		
									<!-- <div ng-repeat="georesourceMetadata in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:mainTopic.topicId} ">
									</div> -->
								</div>
								<!-- end main Topics -->

								<div  class="list-group-item list-group-item-default" style="background: #2171b5; color: white;">
									<a id="noHierarchyGeoresourceDatasets" href="" ng-attr-title="Georessourcen-Daten ohne Themenbezug" class="collapseTrigger" style="color: white;" ng-click="isCollapsed_noTopic = !isCollapsed_noTopic" ng-init="isCollapsed_noTopic=true"><i class="glyphicon glyphicon-chevron-right"></i>ohne Themenbezug ({{$ctrl.kommonitorDataExchangeServiceInstance.getNumberOfGeoresources(null, georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)}})</a>
									&nbsp;&nbsp; <input type="checkbox" value="showAllForTopic_null" ng-model="showAllForTopic_null" ng-change="handleShowAllOnTopic(null)">
								</div>
	
	
								<div class="list-group collapse" uib-collapse="isCollapsed_noTopic">
									
							<div class="georesourceInputForm" ng-if="(($ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:filterByNoTopic() | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:filterByNoTopic() | filter:georesourceNameFilter.value).length > 0) || (($ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:filterByNoTopic() | filter:georesourceNameFilter.value).length > 0)">

								<table class="table table-condensed" style="margin-bottom:0px;">
									<thead>
									  <tr>
										 <th>Typ</th> 
										<th>Datensatz</th>
										<th>Beschreibung</th>
										
										<th>Layer Transparenz</th>
										<th>Legende</th>
										<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
										<th>Export</th>
									  </tr>
									</thead>

									<tbody>

										<!-- POIs -->
										<tr ng-if="showPOI" ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois() | filter:filterByNoTopic() | filter:georesourceNameFilter.value'>
											<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
											<td>
												<i class="fas fa-map-marker-alt"></i>
											</td>
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="poi.datasetName" ng-model="poi.isSelected" ng-change="handlePoiOnMap(poi)">											
		
													<b>&nbsp;&nbsp;{{poi.datasetName}}</b>
												</label>
											</td>
											<td>
												<p>{{poi.metadata.description}}</p>
											</td>
											
											<td>
												<div class="form-group" align="center">


													<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustPOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{dataset.transparency}}</label>
												</div>
											</td>
											<td class="text-center">
												<div align="center">
													<div class="awesome-marker-legend awesome-marker-legend-icon-{{poi.poiMarkerColor}}">
														<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{poi.poiSymbolColor}};" class="glyphicon glyphicon-{{poi.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
													</div>
												</div>	
											</td>
											<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
												<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="poi.selectedDate" ng-change="onChangeSelectedDate(poi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
											</td>
											<td class="text-center">
												<a href="" ng-click="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
												<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
											</td>
										</tr>

										<!-- LOIs -->
										<tr ng-if="showLOI" ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isLOI:true} | filter:filterByNoTopic()'>
											<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
											<td>
												<i class="fas fa-minus"></i>
											</td>
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="loi.datasetName" ng-model="loi.isSelected" ng-change="handleLoiOnMap(loi)">												
	
													<b>&nbsp;&nbsp;{{loi.datasetName}}</b>
												</label>
											</td>
											<td>
												<p>{{loi.metadata.description}}</p>
											</td>
											<td>
												<div class="form-group" align="center">


													<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustLOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{dataset.transparency}}</label>
												</div>
											</td>
											<td class="text-center">
												<div align="center">
													<i style="width:15px; height:15px; background:{{loi.loiColor}}; display:inherit;">
													</i>
												</div>
											</td>
											<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
												<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="loi.selectedDate" ng-change="onChangeSelectedDate(loi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
											</td>
											<td class="text-center">
												<a href="" ng-click="getExportLinkForLoi(loi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
												<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
											</td>
										</tr>

										<!-- AOIs -->
										<tr ng-if="showAOI" ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isAOI:true} | filter:filterByNoTopic()'>
											<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
											<td>
												<i class="far fa-square"></i>
											</td>
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="aoi.datasetName" ng-model="aoi.isSelected" ng-change="handleAoiOnMap(aoi)">													

													<b>&nbsp;&nbsp;{{aoi.datasetName}}</b> 
												</label>
											</td>
											<td>
												<p>{{aoi.metadata.description}}</p>
											</td>
											<td>
												<div class="form-group" align="center">

													<input class=" input-sm" ng-model="aoi.transparency" ng-init="aoi.transparency=0.3" ng-change="adjustAOILayerTransparency(aoi)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{aoi.transparency}}</label>
												</div>
											</td>
											<td class="text-center">
												<div align="center">
													<i style="width:15px; height:15px; background:{{aoi.aoiColor}}; display:inherit;">
													</i>
												</div>
											</td>
											<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
												<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="aoi.selectedDate" ng-change="onChangeSelectedDate(aoi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
											</td>
											<td class="text-center">
												<a href="" ng-click="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
												<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
											</td>
										</tr>

										<!-- WMS -->
										<tr ng-if="showWMS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:georesourceNameFilter.value | filter:filterByNoTopic() | orderBy:"title"'>
											<td>
												<b><i>WMS</i></b>
											</td>
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWmsOnMap(dataset)">

													<b ng-bind-html="dataset.title"></b>
												</label>
											</td>
											<td>
												<p ng-bind-html="dataset.description"></p>
											</td>
											<td>
												<div class="form-group" align="center">

													<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWMSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{dataset.transparency}}</label>
												</div>
											</td>
											
											<td class="text-center">
												<div ng-if="! dataset.showLegend">
													<button class="btn btn-sm btn-primary" ng-click="dataset.showLegend = true;">laden</button>
												</div>
												<div ng-if="dataset.showLegend">
													<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
												</div>
											</td>
											<td>
												-
											</td>
											<td class="text-center">
												<div align="center">
												<a href="{{dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0" title="WMS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
												</div>
											</td>
										</tr>

										<!-- WFS -->
										<tr ng-if="showWFS" ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:filterByNoTopic() | filter:georesourceNameFilter.value  | orderBy:"title"'>
											<td>
												<b><i>WFS</i></b>
											</td>
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWfsOnMap(dataset)">

													<b ng-bind-html="dataset.title"></b>
												</label>
											</td>
											<td>
												<p ng-bind-html="dataset.description"></p>
											</td>
											<td>
												<div class="form-group" align="center">

													<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWFSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{dataset.transparency}}</label>
												</div>
											</td>
											<!-- <td>
												<label class="switch">
													<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
												  <span class="switchslider round"></span>
												</label>
											</td> -->
											
											<td class="text-center">
												<div>
													<div ng-show="dataset.geometryType==='AOI'">
														<div class="input-group colorpicker-component">
															<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.aoiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
															<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
														</div>
													</div>
													<div ng-show="dataset.geometryType==='LOI'">
														<div class="input-group colorpicker-component">
															<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.loiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
															<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
														</div>
													</div>
													<div ng-show="dataset.geometryType==='POI'">
														<div align="center">
															<div class="awesome-marker-legend awesome-marker-legend-icon-{{dataset.poiMarkerColor}}">
																<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{dataset.poiSymbolColor}};" class="glyphicon glyphicon-{{dataset.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
															</div>
														</div>	
													</div>	
												</div>
											</td>
											<td>
												-
											</td>
											<td class="text-center">
												<div align="center">
												<a href="{{dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0" title="WFS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
												</div>
											</td>
										</tr>

									</tbody>

								 </table>	

							</div>
								</div>	
		
		
							</div>

		
					</div>
		
					</uib-tab>
				<uib-tab index="1" heading="Alphabetische Listen">
						<div class="just-padding">
							
							<!-- POINTS OF INTEREST -->
			<div class="box box-primary collapsed-box">
				<div class="box-header with-border">
					<h3 class="box-title">Points of Interest</h3>
		
					<div class="box-tools pull-right">
						<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
						</button>
					</div>
				</div>
				<div class="box-body">
		
					<div class="" >
		
							<!-- <p>Selektieren eines Eintrags aus unten stehender Liste f&uuml;gt den entsprechenden Punkt-Layer der Kartendarstellung hinzu. Deselektion entfernt den entsprechenden Layer aus der Kartendarstellung.</p> -->
		
							<div class="input-group">
								<span class="input-group-addon"><i class="fas fa-filter"></i></span>
								<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="poiNameFilter">
							</div>
		
							<br/>
		
							<div  id="poiInputForm">
		
								<table class="table table-condensed" style="margin-bottom:0px;">
								<thead>
								  <tr>
									<th>Datensatz</th>
									<th>Beschreibung</th>
									<th>Layer Transparenz</th>
									<th>Legende</th>
									<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
									<th>Export</th>
								  </tr>
								</thead>
		
									<tbody>
		
										<tr ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois() | filter:poiNameFilter'>
											<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
											<td>
												<label class='checkbox-inline' ><input type="checkbox" value="poi.datasetName" ng-model="poi.isSelected" ng-change="handlePoiOnMap(poi)">											
		
													<b>&nbsp;&nbsp;{{poi.datasetName}}</b>
												</label>
											</td>
											<td>
												<p>{{poi.metadata.description}}</p>
											</td>
											<td>
												<div class="form-group" align="center">


													<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustPOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

													<br/>

													<label>{{dataset.transparency}}</label>
												</div>
											</td>
											<td class="text-center">
												<div align="center">
													<div class="awesome-marker-legend awesome-marker-legend-icon-{{poi.poiMarkerColor}}">
														<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{poi.poiSymbolColor}};" class="glyphicon glyphicon-{{poi.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
													</div>
												</div>	
											</td>
											<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
												<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="poi.selectedDate" ng-change="onChangeSelectedDate(poi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
											</td>
											<td class="text-center">
												<a href="" ng-click="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
												<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
											</td>
										</tr>
									</tbody>
								</table>
								</div>
		
								<br/>
		
								
		
					</div>
		
				</div>
				<!-- /.box-body -->
		
			</div>
			<!-- /.box -->
		
		
			<!-- LINES OF INTEREST -->
				<div class="box box-primary collapsed-box">
					<div class="box-header with-border">
						<h3 class="box-title">Lines of Interest</h3>
		
						<div class="box-tools pull-right">
							<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
							</button>
						</div>
					</div>
					<div class="box-body">
		
						<div class="" >
		
								<!-- <p>Selektieren eines Eintrags aus unten stehender Liste f&uuml;gt den entsprechenden Punkt-Layer der Kartendarstellung hinzu. Deselektion entfernt den entsprechenden Layer aus der Kartendarstellung.</p> -->
		
								<div class="input-group">
									<span class="input-group-addon"><i class="fas fa-filter"></i></span>
									<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="loiNameFilter">
								</div>
		
								<br/>
		
								<div  id="loiInputForm">
		
									<table class="table table-condensed" style="margin-bottom:0px;">
										<thead>
											<tr>
												<th>Datensatz</th>
												<th>Beschreibung</th>
												<th>Layer Transparenz</th>
												<th>Legende</th>
												<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
												<th>Export</th>
											</tr>
										</thead>
		
										<tbody>
		
											<tr ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isLOI:true} | filter:loiNameFilter'>
												<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
												<td>
													<label class='checkbox-inline' ><input type="checkbox" value="loi.datasetName" ng-model="loi.isSelected" ng-change="handleLoiOnMap(loi)">												
		
														<b>&nbsp;&nbsp;{{loi.datasetName}}</b>
													</label>
												</td>
												<td>
													<p>{{loi.metadata.description}}</p>
												</td>
												<td>
													<div class="form-group" align="center">


														<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustLOILayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

														<br/>

														<label>{{dataset.transparency}}</label>
													</div>
												</td>
												<td class="text-center">
													<div align="center">
														<i style="width:15px; height:15px; background:{{loi.loiColor}}; display:inherit;">
														</i>
													</div>
												</td>
												<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
													<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="loi.selectedDate" ng-change="onChangeSelectedDate(loi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
												</td>
												<td class="text-center">
													<a href="" ng-click="getExportLinkForLoi(loi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
													<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
												</td>
											</tr>
										</tbody>
									</table>
									</div>
		
						</div>
		
					</div>
					<!-- /.box-body -->
				</div>
				<!-- /.box -->
		
		
				<!-- AREAS OF INTEREST -->
					<div class="box box-primary collapsed-box">
						<div class="box-header with-border">
							<h3 class="box-title">Areas of Interest</h3>
		
							<div class="box-tools pull-right">
								<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
								</button>
							</div>
						</div>
						<div class="box-body">
		
							<div class="" >
		
									<!-- <p>Selektieren eines Eintrags aus unten stehender Liste f&uuml;gt den entsprechenden Punkt-Layer der Kartendarstellung hinzu. Deselektion entfernt den entsprechenden Layer aus der Kartendarstellung.</p> -->
		
									<div class="input-group">
										<span class="input-group-addon"><i class="fas fa-filter"></i></span>
										<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="aoiNameFilter">
									</div>
		
									<br/>
		
									<div  id="aoiInputForm">
		
										<table class="table table-condensed" style="margin-bottom:0px;">
										<thead>
										  <tr>
											<th>Datensatz</th>
											<th>Beschreibung</th>
											<th>Layer Transparenz</th>
											<th>Legende</th>
											<th ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">Zeitschnitt</th>
											<th>Export</th>
										  </tr>
										</thead>
		
											<tbody>
		
												<tr ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:{isAOI:true} | filter:aoiNameFilter'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<label class='checkbox-inline' ><input type="checkbox" value="aoi.datasetName" ng-model="aoi.isSelected" ng-change="handleAoiOnMap(aoi)">													
		
															<b>&nbsp;&nbsp;{{aoi.datasetName}}</b> 
														</label>
													</td>
													<td>
														<p>{{aoi.metadata.description}}</p>
													</td>
													<td>
														<div class="form-group" align="center">

															<input class=" input-sm" ng-model="aoi.transparency" ng-init="aoi.transparency=0.3" ng-change="adjustAOILayerTransparency(aoi)" type="range"  min="0" max="1" step="0.01">

															<br/>

															<label>{{aoi.transparency}}</label>
														</div>
													</td>
													<td class="text-center">
														<div align="center">
															<i style="width:15px; height:15px; background:{{aoi.aoiColor}}; display:inherit;">
															</i>
														</div>
													</td>
													<td ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
																ng-model="aoi.selectedDate" ng-change="onChangeSelectedDate(aoi)" ng-options="date as date.startDate + ' - ' + date.endDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate'" ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																class="form-control" required>
															</select>
													</td>
													<td class="text-center">
														<a href="" ng-click="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a>
														<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download as GeoJSON"><i class="fas fa-file-download"></i></a> -->
													</td>
												</tr>
											</tbody>
										</table>
										</div>
		
							</div>
		
						</div>
						<!-- /.box-body -->
					</div>
					<!-- /.box -->


					<!-- WMS -->
				<div class="box box-primary collapsed-box">
					<div class="box-header with-border">
						<h3 class="box-title">Web Map Service (WMS)</h3>

						<div class="box-tools pull-right">
							<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
							</button>
						</div>
					</div>
					<div class="box-body">

											<div class="input-group">
												<span class="input-group-addon"><i class="fas fa-filter"></i></span>
												<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="wmsNameFilter">
											</div>

											<br/>

											<div  id="wmsInputForm">

												<table class="table table-condensed" style="margin-bottom:0px;">
											    <thead>
											      <tr>
											        <th>Datensatz</th>
											        <th>Beschreibung</th>
															<th>Layer Transparenz</th>
															<th>WMS URL</th>
															<th>Legende</th>
											      </tr>
											    </thead>

													<tbody>

														<tr ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:wmsNameFilter | orderBy:"title"'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWmsOnMap(dataset)">

																	<b ng-bind-html="dataset.title"></b>
																</label>
															</td>
															<td>
																<p ng-bind-html="dataset.description"></p>
															</td>
															<td>
																<div class="form-group" align="center">

																	<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWMSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																	<br/>

																	<label>{{dataset.transparency}}</label>
																</div>
															</td>
															<td class="text-center">
																<div align="center">
																<a href="{{dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0" title="WMS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																</div>
															</td>
															<td class="text-center">
																<div ng-if="! dataset.showLegend">
																	<button class="btn btn-sm btn-primary" ng-click="dataset.showLegend = true;">laden</button>
																</div>
																<div ng-if="dataset.showLegend">
																	<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
																</div>
															</td>
														</tr>
													</tbody>
												</table>
												</div>

												<br/>

											<div align="center">

												<button class="btn btn-success" type="button" data-toggle="modal" data-target="#modal-add-wms">Eigenen WMS hinzuladen</button>

											</div>

	              </div>
	              <!-- /.box-body -->

						</div>
						<!-- /.box -->

						<!-- WfS -->
							<div class="box box-primary collapsed-box">
								<div class="box-header with-border">
									<h3 class="box-title">Web Feature Service (WFS)</h3>

									<div class="box-tools pull-right">
										<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
										</button>
									</div>
								</div>
								<div class="box-body">

														<p>Hinzuladen eines WFS kann je nach Objektanzahl und -komplexität einige Moment dauern. Die Features werden zudem nach dem aktuellen Raumausschnitt der Kartendarstellung gefiltert abgefragt.</p>

														<div class="input-group">
															<span class="input-group-addon"><i class="fas fa-filter"></i></span>
															<input type="text" class="form-control input-sm" placeholder="Stichwortfilter" ng-model="wfsNameFilter">
														</div>

														<br/>

														<div  id="wfsInputForm">

															<table class="table table-condensed" style="margin-bottom:0px;">
														    <thead>
														      <tr>
														        <th>Datensatz</th>
														        <th>Beschreibung</th>
																		<th>Layer Transparenz</th>
																		<th>auf aktuellen Raumausschnitt beschr&auml;nken</th>
																		<th>WFS URL</th>
																		<th>Legende</th>
														      </tr>
														    </thead>

																<tbody>

																	<tr ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.wfsDatasets | filter:wfsNameFilter | orderBy:"title"'>
																		<td>
																			<label class='checkbox-inline' ><input type="checkbox" value="dataset.title" ng-model="dataset.isSelected" ng-change="handleWfsOnMap(dataset)">

																				<b ng-bind-html="dataset.title"></b>
																			</label>
																		</td>
																		<td>
																			<p ng-bind-html="dataset.description"></p>
																		</td>
																		<td>
																			<div class="form-group" align="center">

																				<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="adjustWFSLayerTransparency(dataset)" type="range"  min="0" max="1" step="0.01">

																				<br/>

																				<label>{{dataset.transparency}}</label>
																			</div>
																		</td>
																		<td>
																			<label class="switch">
																				<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																			  <span class="switchslider round"></span>
																			</label>
																		</td>
																		<td class="text-center">
																			<div align="center">
																			<a href="{{dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0" title="WFS GetCapabilities URL" rel='noopener noreferrer' target='_blank'><i class="fas fa-cloud-download-alt"></i></a>
																			</div>
																		</td>
																		<td class="text-center">
																			<div>
																				<div ng-show="dataset.geometryType==='AOI'">
																					<div class="input-group colorpicker-component">
																						<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.aoiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																						<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																					</div>
																				</div>
																				<div ng-show="dataset.geometryType==='LOI'">
																					<div class="input-group colorpicker-component">
																						<input type="text" style="display:none;" class="form-control input-sm" ng-model="dataset.loiColor" ng-change="adjustWfsLayerColor(dataset)" placeholder="WFS Darstellungsfarbe"  required />
																						<span title="Klicken, um die Farbe anzupassen" style="border: 1px solid #ccc;" class="input-group-addon"><i></i></span>
																					</div>
																				</div>
																				<div ng-show="dataset.geometryType==='POI'">
																					<div align="center">
																						<div class="awesome-marker-legend awesome-marker-legend-icon-{{dataset.poiMarkerColor}}">
																							<span style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{dataset.poiSymbolColor}};" class="glyphicon glyphicon-{{dataset.poiSymbolBootstrap3Name}}" aria-hidden="true"></span>
																						</div>
																					</div>	
																				</div>	
																			</div>
																		</td>
																	</tr>
																</tbody>
															</table>
															</div>

															<br/>

														<div align="center">

															<button class="btn btn-success" type="button" data-toggle="modal" data-target="#modal-add-wfs">Eigenen WFS hinzuladen</button>

														</div>

				              </div>
				              <!-- /.box-body -->

									</div>
									<!-- /.box -->
		
		
						</div>
					</uib-tab>
			  </uib-tabset>

		</div>
		
	</div>	

</div>
