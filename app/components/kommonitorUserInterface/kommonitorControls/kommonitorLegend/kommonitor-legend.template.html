<div id="kommonitorLegend" ng-show="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator">

	<p></p>

	<!-- Indicator information  -->
		<div class="box box-primary">
			<div class="box-header with-border">
				<h3 class="box-title" ng-bind-html="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorName"></h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body boxedLegend">
				<div >
					<div>
						<h5 ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.isCustomComputation">&nbsp;-&nbsp; <i>individuelles Berechnungsergebnis</i></h5>
						<br />
						<b>Beschreibung: </b> 
						<p ng-bind-html="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.metadata.description"></p>
						<!-- <br /> -->
						<!-- <b>Datenquelle: </b> 
						<p ng-bind-html="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.metadata.datasource"></p> -->
						<!-- <div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.processDescription && $ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.processDescription != ''">
							<b>Methodikhinweise: </b> 
							<p mathjax-bind="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.processDescription"></p>
						</div>						 -->
						<br />
						<!-- <div class="row" style="margin-right: 0px;">
							<div class="col-sm-3">
								<div class="text-left"><label>Raumebene: </label></div>
							</div>
							<div class="col-sm-9">
								<select ng-model="$ctrl.kommonitorDataExchangeServiceInstance.selectedSpatialUnit"
									ng-options="spatialUnit as spatialUnit.spatialUnitLevel for spatialUnit in $ctrl.kommonitorDataExchangeServiceInstance.availableSpatialUnits | filter:filterSpatialUnits()"
									class="form-control" ng-change="onChangeSelectedSpatialUnit()" required>
									<option disabled selected value> -- Raumeinheit w&auml;hlen --
									</option>
								</select>
							</div>
						</div><br> -->

						<div class="row" style="margin-right: 0px;">
							<div class="col-sm-7">
								<div class="text-left"><label>Raumebene</label></div>
								<select style="font-size: 12px;" ng-model="$ctrl.kommonitorDataExchangeServiceInstance.selectedSpatialUnit"
									ng-options="spatialUnit as spatialUnit.spatialUnitLevel for spatialUnit in $ctrl.kommonitorDataExchangeServiceInstance.availableSpatialUnits | filter:filterSpatialUnits()"
									class="form-control" ng-change="onChangeSelectedSpatialUnit()" required>
									<option disabled selected value> -- Raumeinheit w&auml;hlen --
									</option>
								</select>
							</div>
							<div class="col-sm-5">
								<div class="text-left"><label>Datum</label></div>
								<input id="indicatorDatePicker" type="text" placeholder="YYYY-MM-DD" 
								ng-model="$ctrl.kommonitorDataExchangeServiceInstance.selectedDate" ng-change="onChangeIndicatorDatepickerDate()"
								ng-disabled="$ctrl.kommonitorDataExchangeServiceInstance.disableIndicatorDatePicker">
							</div>
						</div><br>

						<div class="row vertical-align" style="margin-right:0px;">
							<div class="col-sm-3">
								<div class="text-left"><label>Transparenz</label></div>
							</div>
							<div class="col-sm-7">
								<div class="text-left"><input style="width:100%;" id="indicatorTransparencyInput" type="range" value="{{$ctrl.kommonitorVisualStyleHelperServiceInstance.indicatorTransparency}}" min="0" max="1" step="0.01"></div>
							</div>
							<div class="col-sm-2">
								<div class="text-left"><label id="indicatorTransparencyLabel" >{{$ctrl.kommonitorVisualStyleHelperServiceInstance.indicatorTransparency}}</label></div>
							</div>
						</div><br>
						<div class="btn-group">
							<label><i class="fa fa-file-download"></i>&nbsp;&nbsp;&nbsp;Export</label>
							<br />
							<button id="downloadMetadata" ng-click="onClickDownloadMetadata()" class="btn btn-default btn-xs">Metadatenblatt</button>
							<button id="downloadGeoJSON" ng-click="downloadIndicatorAsGeoJSON()" class="btn btn-primary btn-xs">GeoJSON</button>
							<button id="downloadShape" ng-click="downloadIndicatorAsShape()" class="btn btn-primary btn-xs">ESRI
								Shape</button>
							<a style="color:white;pointer-events: none;cursor: default;" class="btn btn-primary btn-xs disabled" ng-href="$ctrl.kommonitorDataExchangeServiceInstance.wmsUrlForSelectedIndicator"
								target="_blank" rel="noopener noreferrer" id="downloadWMS"><span
									title="WMS Link in Zukunft abrufbar">WMS</span></a>
							<a style="color:white;pointer-events: none;cursor: default;" class="btn btn-primary btn-xs disabled" ng-href="$ctrl.kommonitorDataExchangeServiceInstance.wfsUrlForSelectedIndicator"
								target="_blank" rel="noopener noreferrer" id="downloadWFS"><span
									title="WFS Link in Zukunft abrufbar">WFS</span></a>
						</div>
					</div>

				</div>

			</div>
			<!-- /.box-body -->
		</div>
		<!-- /.box -->

		<!-- classification  -->
		<div class="box box-primary collapsed-box">
			<div class="box-header with-border">
				<h3 class="box-title">Klassifikation anpassen</h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
					</button>
				</div>
			</div>
			<div class="box-body boxedLegend">

				<strong
					title="Hier können Sie die Klassifizierungsmethode ändern. Das Herüberfahren des Mauszeigers über eine der Optionen öffnet einen Tooltip mit Informationen zu den Methoden. In Zukunft sollen auch manuelle Klassifikationen möglich gemacht werden.">Klassifizierungsmethode:</strong>
				<form>
					<div> 
						<label
							title="Bei Jenks (Natürliche Unterbrechungen) werden Klassengrenzen identifiziert, die ähnliche Werte möglichst gut gruppieren und zugleich die Unterschiede zwischen den Klassen maximieren."
							class="radio-inline"><input id="radiojenks" type="radio" ng-model="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod" ng-checked="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod == 'jenks'" name="classifyMethod">Jenks</label> 
						<label
							title="Mit der Methode Gleiches Intervall wird der Bereich der Attributwerte in gleich große Teilbereiche unterteilt."
							class="radio-inline"><input id="radioequal_interval" type="radio" ng-model="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod" ng-checked="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod == 'equal_interval'" name="classifyMethod"
								checked="">Gleiches Intervall</label> 
						<label
							title="Bei der Quantil-Methode enthält jede Klasse die gleiche Anzahl von Features."
							class="radio-inline"><input id="radioquantile" type="radio" ng-model="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod" ng-checked="$ctrl.kommonitorVisualStyleHelperServiceInstance.classifyMethod == 'quantile'" name="classifyMethod">Quantile</label>
					</div>
				</form>
				<br>

				<div>
					<strong>Klassifizierung &uuml;ber die gesamte Zeitreihe</strong> &nbsp;
					<label class="switch" title="Klassifizierung &uuml;ber die gesamte Zeitreihe"><input id="controlIndicatorClassifyOption_wholeTimeseries" type="checkbox" value="useWholeTimeseriesClassification" ng-model="$ctrl.kommonitorDataExchangeServiceInstance.classifyUsingWholeTimeseries" ng-checked="$ctrl.kommonitorDataExchangeServiceInstance.classifyUsingWholeTimeseries"><span class="switchslider round"></span></label>
				</div>

				<div ng-if="containsZeroValues">
					<strong>Wert "0" als separate Klasse darstellen</strong> &nbsp;
					<label class="switch" title="0 als separate Klasse darstellen"><input id="controlIndicatorZeroClassifyOption" type="checkbox" value="useSeparateZeroClass" ng-model="$ctrl.kommonitorDataExchangeServiceInstance.classifyZeroSeparately" ng-checked="$ctrl.kommonitorDataExchangeServiceInstance.classifyZeroSeparately"><span class="switchslider round"></span></label>
				</div>

				<div ng-if="containsOutliers_high || containsOutliers_low">
					<strong>Ausrei&szlig;er gesondert markieren</strong> &nbsp;
					<label class="switch" title="Ausrei&szlig;er gesondert markieren"><input id="controlIndicatorOutlierDetection" type="checkbox" value="useOutlierDetection" ng-model="$ctrl.kommonitorDataExchangeServiceInstance.useOutlierDetectionOnIndicator" ng-checked="$ctrl.kommonitorDataExchangeServiceInstance.useOutlierDetectionOnIndicator"><span class="switchslider round"></span></label>
				</div>
				
			</div>
			<!-- /.box-body -->
		</div>
		<!-- /.box -->

		<!-- legend(s)  -->
		<div class="box box-primary">
			<div class="box-header with-border">
				<h3 class="box-title">Legenden</h3>

				<div class="box-tools pull-right">
					<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="box-body boxedLegend" ng-if="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator">

				<uib-tabset active="0">
					<uib-tab index="0" heading="Indikator">

						<div class="just-padding">
							<h4>{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorStringFromIndicatorType($ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorType)}}</h4>
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorType.includes('STATUS') && ! $ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">
								<em>Darstellung der Indikatorenwerte zum gew&auml;hlten Zeitpunkt {{$ctrl.kommonitorDataExchangeServiceInstance.tsToDate_fullYear($ctrl.kommonitorDataExchangeServiceInstance.dateToTS(dateAsDate))}}</em>
							</div>
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorType.includes('DYNAMIC') && ! $ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">
								<em>Darstellung der zeitlichen Entwicklung zum gew&auml;hlten Zeitpunkt {{$ctrl.kommonitorDataExchangeServiceInstance.tsToDate_fullYear($ctrl.kommonitorDataExchangeServiceInstance.dateToTS(dateAsDate))}}</em>
							</div>
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">
								<em>Schwellwert-Klassifizierzung</em>
								<em>Gew&auml;hlter Zeitpunkt: </em> {{$ctrl.kommonitorDataExchangeServiceInstance.tsToDate_fullYear($ctrl.kommonitorDataExchangeServiceInstance.dateToTS(dateAsDate))}}
								<em>aktueller Schwellwert: </em> {{$ctrl.kommonitorDataExchangeServiceInstance.measureOfValue}}
							</div>
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.isBalanceChecked">
								<em>Bilanzierung - {{$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator['fromDate']}} - {{$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator['toDate']}}</em>
							</div>
							
							<br />
							
							<label>Einheit: </label> 
							<p ng-bind-html="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.unit"></p>	
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.interpretation && $ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.interpretation != ''">
								<label>Interpretationshilfe:</label>
								<p ng-bind-html="$ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.interpretation"></p>	
							</div>						
							<br />				
							

							<div class="row" style="margin-right: 0px;">
								<div class="col-md-3"><b>Symbolik</b></div>
								<div class="col-md-6"><b>Wertebereich</b></div>
								<div class="col-md-3"><b>Fallzahl</b></div><br>
							</div>
							<div ng-if="containsNoData">
								<div class="row" style="margin-right: 0px;">
									<div class="col-md-3"><i style="background:{{$ctrl.env.defaultColorForNoDataValues}}; border: 2px solid {{$ctrl.env.defaultBorderColorForNoDataValues}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i></div>
									<div class="col-md-6">Leerwert</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerNoData}}</div><br>
								</div>				
							</div>
							<div ng-if="containsOutliers_low && $ctrl.kommonitorDataExchangeServiceInstance.useOutlierDetectionOnIndicator">
								<div class="row" style="margin-right: 0px;">
									<div class="col-md-3"><i ng-bind-html="svgString_outlierLow"></i></div>
									<div class="col-md-6">untere Ausrei&szlig;er {{makeOutliersLowLegendString(outliers_low)}}</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerOutlierLow}}</div><br>
								</div>				
							</div>
							<div ng-if="containsOutliers_high && $ctrl.kommonitorDataExchangeServiceInstance.useOutlierDetectionOnIndicator">
								<div class="row" style="margin-right: 0px;">
									<div class="col-md-3"><i ng-bind-html="svgString_outlierHigh"></i></div>
									<div class="col-md-6">obere Ausrei&szlig;er {{makeOutliersHighLegendString(outliers_high)}}</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerOutlierHigh}}</div><br>
								</div>				
							</div>
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.filteredIndicatorFeatureNames.length > 0">
								<div class="row" style="margin-right: 0px;">
									<div class="col-md-3"><i style="background:{{$ctrl.env.defaultColorForFilteredValues}}; border: 2px solid {{$ctrl.env.defaultBorderColorForFilteredValues}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i></div>
									<div class="col-md-6">gefilterte Features</div>
									<div class="col-md-3">{{$ctrl.kommonitorDataExchangeServiceInstance.filteredIndicatorFeatureNames.length}}</div><br>
								</div>				
							</div>
							<br/>
							<!-- Measure of Value legend items -->
							<div ng-if="$ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">
								<!-- zero -->
								<div class="row" style="margin-right: 0px;" ng-if="$ctrl.kommonitorDataExchangeServiceInstance.classifyZeroSeparately && containsZeroValues">
									<div class="col-md-3"><i style="background:{{$ctrl.env.defaultColorForZeroValues}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i></div>
									<div class="col-md-6">0</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerZero}}</div><br>
								</div>	

								<br/>

								<!-- lesser than values -->
								<div class="row" style="margin-right: 0px;" ng-repeat="color in $ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].colors">
									<div class="col-md-3 "><i style="background:{{color}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i> </div>
									<div class="col-md-6 " ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].breaks[$index])}} &dash; &lt; {{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].breaks[$index + 1])}}</div>
									<div class="col-md-6 " ng-if="! $ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[1].breaks[$index])}}</div>
									<div class="col-md-3 ">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerColorMap.get(color) || 0}}</div>
								</div>

								<br/>

								<!-- higher than values -->
								<div class="row" style="margin-right: 0px;" ng-repeat="color in $ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].colors">
									<div class="col-md-3 "><i style="background:{{color}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i> </div>
									<div class="col-md-6 " ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].breaks[$index])}} &dash; &lt; {{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].breaks[$index + 1])}}</div>
									<div class="col-md-6 " ng-if="! $ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.measureOfValueBrew[0].breaks[$index])}}</div>
									<div class="col-md-3 ">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerColorMap.get(color) || 0}}</div>
								</div>

							</div>
							<!-- Dynamic legend items -->
							<div ng-if="($ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorType.includes('DYNAMIC') || containsNegativeValues) && ! $ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">					

								<!-- < 0 values -->
								<div class="row" style="margin-right: 0px;" ng-repeat="color in $ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].colors">
									<div class="col-md-3 "><i style="background:{{color}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i> </div>
									<div class="col-md-6 " ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].breaks[$index])}} &dash; &lt; {{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].breaks[$index + 1])}}</div>
									<div class="col-md-6 " ng-if="! $ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[1].breaks[$index])}}</div>
									<div class="col-md-3 ">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerColorMap.get(color) || 0}}</div>
								</div>

								<br/>

								<!-- zero -->
								<div class="row" style="margin-right: 0px;" ng-if="$ctrl.kommonitorDataExchangeServiceInstance.classifyZeroSeparately && containsZeroValues">
									<div class="col-md-3"><i style="background:{{$ctrl.env.defaultColorForZeroValues}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i></div>
									<div class="col-md-6">0</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerZero}}</div><br>
								</div>	

								<br />

								<!-- > 0 values -->
								<div class="row" style="margin-right: 0px;" ng-repeat="color in $ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].colors">
									<div class="col-md-3 "><i style="background:{{color}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i> </div>
									<div class="col-md-6 " ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].breaks[$index])}} &dash; &lt; {{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].breaks[$index + 1])}}</div>
									<div class="col-md-6 " ng-if="! $ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.dynamicBrew[0].breaks[$index])}}</div>
									<div class="col-md-3 ">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerColorMap.get(color) || 0}}</div>
								</div>
							</div>

							<!-- Static/Status legend items -->
							<div ng-if="($ctrl.kommonitorDataExchangeServiceInstance.selectedIndicator.indicatorType.includes('STATUS') && ! containsNegativeValues) && ! $ctrl.kommonitorDataExchangeServiceInstance.isMeasureOfValueChecked">
								<!-- zero -->
								<div class="row" style="margin-right: 0px;" ng-if="$ctrl.kommonitorDataExchangeServiceInstance.classifyZeroSeparately && containsZeroValues">
									<div class="col-md-3"><i style="background:{{$ctrl.env.defaultColorForZeroValues}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i></div>
									<div class="col-md-6">0</div>
									<div class="col-md-3">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerZero}}</div><br>
								</div>	

								<br />

								<!-- default values -->
								<div class="row" style="margin-right: 0px;" ng-repeat="color in $ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.colors">
									<div class="col-md-3 "><i style="background:{{color}}; opacity: {{$ctrl.kommonitorVisualStyleHelperServiceInstance.currentIndicatorOpacity}};"></i> </div>
									<div class="col-md-6 " ng-if="$ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.breaks[$index])}} &dash; &lt; {{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.breaks[$index + 1])}}</div>
									<div class="col-md-6 " ng-if="! $ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.breaks[$index + 1]" >{{$ctrl.kommonitorDataExchangeServiceInstance.getIndicatorValue_asFormattedText($ctrl.kommonitorVisualStyleHelperServiceInstance.defaultBrew.breaks[$index])}}</div>
									<div class="col-md-3 ">{{$ctrl.kommonitorVisualStyleHelperServiceInstance.featuresPerColorMap.get(color) || 0}}</div>
								</div>
							</div>
						</div>
				
					</uib-tab>

					<uib-tab index="1" heading="Isochronen" disable="!$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend">

						<div class="just-padding">
							<div align="center">
								<div class="legend" align="left">
									<label>Fortbewegungsart:
									</label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.transitMode}}
									<br />
									<div ng-show="$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.reachMode === 'Zeit'">
										<label>maximale Geschwindigkeit: </label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.speedInKilometersPerHour}} km/h
										<br />
									</div>
									<label>Abbruchkriterium: </label>&nbsp;
									{{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.reachMode}}
									<br />
									<label>Einheit: </label>&nbsp;
									{{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.cutOffUnit}}
									<br />
									<div
										ng-repeat="entry in $ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.colorValueEntries">
										<i style="background: {{entry.color}}; opacity: 0.3;"></i> {{entry.value}}
									</div>
								</div>
							</div>
							
						</div>						
					</uib-tab>

					<uib-tab index="2" heading="Routing" disable="!$ctrl.kommonitorDataExchangeServiceInstance.routingLegend">

						<div class="just-padding">
							<div align="center">
								<div class="legend" style="width:unset; max-width:unset" align="left">									
									<label>Fortbewegungsart:
									</label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.transitMode}}
									<br />
									<label>Routing-Typ: </label>&nbsp;
									{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.preference}}
									<br />
				
									<div>
										<i style="background: #ed561a; opacity:0.7;"></i> Pfad in Kartendarstellung
									</div>
				
									<br />
									<table class="table table-condensed">
										<thead>
											<tr>
												<th>Startpunkt</th>
												<th>Endpunkt</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.routingStartPoint.label}}</td>
												<td>{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.routingEndPoint.label}}</td>
											</tr>
										</tbody>
									</table>
				
									<table class="table table-condensed">
										<thead>
											<tr>
												<th>Dauer</th>
												<th>Distanz</th>
												<th>Durchschnittsgeschwindigkeit</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.routeDuration_minutes}} Minuten</td>
												<td>{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.routeDistance_km}} km</td>
												<td>{{$ctrl.kommonitorDataExchangeServiceInstance.routingLegend.routeAvgSpeed_kmh}} km/h</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					
					</uib-tab>

					<uib-tab index="3" heading="WMS-Dienste">

						<div class="just-padding">
							<table class="table table-condensed " style="margin-bottom:0px;">
								<thead>
								  <tr>
									<th>Datensatz</th>
									<th>Layer Transparenz</th>
									<th>Legende</th>
								  </tr>
								</thead>

								<tbody>

									<tr ng-repeat="dataset in $ctrl.kommonitorDataExchangeServiceInstance.wmsDatasets | filter:{isSelected:'true'} | orderBy:'title'">										
										<td>
											<label ng-bind-html="dataset.title">
											</label>
										</td>
										<td>
											<div class="form-group" align="center">

												<input class=" input-sm" ng-model="dataset.transparency" ng-init="dataset.transparency=0" ng-change="$ctrl.kommonitorMapServiceInstance.adjustOpacityForWmsLayer(dataset, 1 - dataset.transparency);" type="range"  min="0" max="1" step="0.01">

												<br/>

												<label>{{dataset.transparency}}</label>
											</div>
										</td>
										
										<td class="text-center">
											<img src="{{dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{dataset.layerName}}">
										</td>
									</tr>

								</tbody>
							</table>
						</div>	
					</uib-tab>

				
				</uib-tabset>

				

			</div>
			<!-- /.box-body -->
		</div>
		<!-- /.box -->


</div>
