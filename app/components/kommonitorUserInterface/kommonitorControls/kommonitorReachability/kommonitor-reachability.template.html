<div id="kommonitorReachability">

	<div align="center">
		<div class="loading-overlay-sidebar-small ng-hide"
			ng-show="loadingData">
			<span class="glyphicon glyphicon-refresh icon-spin"></span>
		</div>
	</div>

	<p></p>

	<div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Erreichbarkeitsanalysen</h3>
							<p style="margin: 0 0 0px;">auf Basis von Stra&szlig;en- und Wegenetzen</p>

							<div class="box-tools pull-right">
								<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
								</button>
							</div>
            </div>
            <!-- /.box-header -->

						<div class="box-body">
							<label for="TODO">Berechnungsaufgabe:</label>

							<br />

							<div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
								<label class="btn btn-primary active">
									<input type="radio" name="btn_show_iso" id="btn_isochrones" ng-change="showIso()" autocomplete="off" checked ng-model="showIsochrones" value="true">Isochronenberechnung</input>
								</label>
								<label class="btn btn-primary">
									<input type="radio" name="btn_show_rout" id="btn_routing" ng-change="showRouting()" autocomplete="off" ng-model="showIsochrones" value="false">Routing</input>
								</label>
							</div>
							<!--
								<label>showIsochrones= {{showIsochrones}}, transitMode= {{transitMode}}</label>
							 -->
							<br />

							<div ng-show="showIsochrones" class="ng-show" id="isochoneCalculation">
							<label for="TODO">Verkehrsmittel</label>
							<br />
								<div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
									<label class="btn btn-primary active">
										<input type="radio" name="options" id="optFeet" autocomplete="off" checked ng-change="changeType()" ng-model="transitMode" value="foot-walking"> Fu&szlig;g&aumlnger
									</label>
									<label class="btn btn-primary">
										<input type="radio" name="options" id="optBike" autocomplete="off" ng-change="changeType()" ng-model="transitMode" value="cycling-regular"> Fahrrad
									</label>
									<label class="btn btn-primary">
										<input type="radio" name="options" id="optCar" autocomplete="off" ng-change="changeType()" ng-model="transitMode" value="driving-car"> Auto
									</label>
								</div>
								<!--
									<label>{{transitMode}}</label>
							 	-->
								<br />

								<label for="TODO">Analysefokus</label>

								<br />

								<div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
									<label class="btn btn-primary active">
										<input type="radio" name="options" id="focus_distance" autocomplete="off" checked ng-change="changeFocus()" ng-model="focus" value="distance">Distanz</input>
									</label>
									<label class="btn btn-primary">
										<input type="radio" name="options" id="focus_time" autocomplete="off" ng-change="changeFocus()" ng-model="focus" value="time"> Zeit</input>
									</label>
								</div>

								<!--
									<label>Fokus= {{focus}}, Time= {{isTime}}</label>
								-->

								<br />
								<hr>
								<br />

								<div class="rangeslider">
									<label for="TODO">Distanz / Zeit</label>

									<div class="row vertical-align" style="margin-right:0px;">
						        <div class="col-md-4 col-sm-4 col-xs-4">
											<input type="range" min="1" max={{max_value}} value="1" class="myslider" id="timeOrDistSlider" ng-model="currentTODValue">
											<br />
											<label>Wert: {{currentTODValue}} {{unit}}</label>

											<label>Maximum: {{max_value}} {{unit}}</label>
										</div>
										<div class="col-md-8 col-sm-8 col-xs-8">
											<p>F&uuml;r die Definition mehrerer Isochronen nutzen Sie bitte das nachfolgende Textfeld. Geben Sie die gew&uuml;nschten Isochronengrenzen kommagetrennt ein (Beispiel: '100,200,300' in Metern oder '5,10,20' f&uuml;r Minuten).</p>
											<div class="horizontal-align">
												<input id="isoInputText" type="text" onkeypress="isInputAllowed(event)">
											</div>

											<script>
												function isInputAllowed(evt) {
													var code = (evt.keyCode ? evt.keyCode : evt.which);
													if (code == 8) { //Backspace key press
														return true;
													} else {
														var ch = String.fromCharCode(evt.which);
														if (!(/[0-9,]/.test(ch))) {
															evt.preventDefault();
														}
													}
												}
											</script>
										</div>
									</div>
									<!-- <br />
									<br /> -->

								</div>

								<br />

								<div ng-show="isTime" class="ng-show" class="rangeslider">
									<label for="TODO">Tempoauswahl</label>
									<br />
									<br />
									<input type="range" min={{minSpeedInKilometersPerHour}} max={{maxSpeedInKilometersPerHour}} value={{minSpeedInKilometersPerHour}} class="myslider" id="tempoSlider" ng-model="speedInKilometersPerHour">
									<br />
									<label>Wert: {{speedInKilometersPerHour}} km/h; Maximum: {{maxSpeedInKilometersPerHour}} km/h</label>
									<br />
									<br />
								</div>

								<hr>
								<br/>

								<label for="TODO">Startpunkte</label>

								<br />

								<div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
									<label class="btn btn-primary active">
										<input type="radio" name="options" id="startPointsSource_layer" autocomplete="off" checked ng-change="changeStartPointsSource()" ng-model="startPointsSource" value="fromLayer">aus Punkt-Layer</input>
									</label>
									<label class="btn btn-primary">
										<input type="radio" name="options" id="startPointsSource_draw" autocomplete="off" ng-change="changeStartPointsSource()" ng-model="startPointsSource" value="manual">Punkte zeichnen</input>
									</label>
								</div>

								<!--
									<label>Fokus= {{focus}}, Time= {{isTime}}</label>
								-->

								<br />

								<div ng-show="startPointsSource === 'fromLayer'">

									<div class="row vertical-align" style="margin-right:0px;">
						        <div class="col-md-6 col-sm-6 col-xs-6">
											<div class="horizontal-align" ng-show="selectedStartPointLayer.geoJSON">
												<p><b>{{selectedStartPointLayer.geoJSON.features.length}}</b> Startpunkte im selektierten Layer</p>
											</div>

											<div class="horizontal-align" ng-hide="selectedStartPointLayer">
												<p>noch kein Layer selektiert</p>
											</div>
										</div>
										<div class="col-md-6 col-sm-6 col-xs-6">
											<select style="font-size: 12px;"
												ng-model="selectedStartPointLayer" ng-options="poi as poi.datasetName for poi in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois()"
												ng-change="onChangeSelectedStartPointLayer()" class="form-control" required>
												<option disabled selected value> -- Punkt-Layer w&auml;hlen -- </option>
											</select>
										</div>
									</div>
								</div>

								<div ng-show="startPointsSource === 'manual'">

									<p>Zeichnen Sie selbst Punkte in die Karte. Dazu nutzen Sie bitte das Zeichen-Werkzeug in der unteren linken Ecke der Karte.</p>

									<div class="row vertical-align" style="margin-right:0px;">
						        <div class="col-md-6 col-sm-6 col-xs-6">
											<div class="horizontal-align" ng-show="manualStartPoints.features.length > 0">
 	 										<p><b>{{manualStartPoints.features.length}}</b> Startpunkte gezeichnet</p>
 	 									</div>

 	 									<div class="horizontal-align" ng-hide="manualStartPoints.features.length > 0">
 	 										<p>noch keine Start-Punkte gezeichnet</p>
 	 									</div>
						        </div>
										<div class="col-md-6 col-sm-6 col-xs-6">
						         <button type="button" class="btn btn-danger btn-sm" ng-click="removeAllDrawnPoints()" >Punkte entfernen</button>
						        </div>
									</div>
								</div>

								<br/>
								<hr>
								<br/>

							</div>
							<div ng-hide="showIsochrones" class="ng-hide" id="routing">
									<div class="form-group">
									    <label for="transitModeList">Verkehrsmittel</label>
									    <select class="form-control" id="transitModeList" ng-change="changeTransitMode()" ng-model="transitMode">
									      <option value="driving-car">Auto</option>
									      <option value="driving-hgv">LKW</option>
									      <option value="cycling-regular">Fahrrad normal</option>
									      <option value="cycling-road">Fahrrad asphaltiert</option>
									      <option value="cycling-safe">Fahrrad separiert</option>
									      <option value="cycling-mountain">Farrad offroad</option>
									      <option value="cycling-tour">Fahrrad tour</option>
									      <option value="cycling-electric">Fahrrad elektrisch</option>
									      <option value="foot-walking">Laufen</option>
									      <option value="foot-hiking">Wandern</option>
									      <option value="wheelchair">Rollstuhl</option>
									    </select>
									  </div>
									<br />

									<div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
										<label class="btn btn-primary active">
											<input type="radio" name="options" id="optFastest" autocomplete="off" checked  ng-model="preference" value="fastest">Schnellste
										</label>
										<label class="btn btn-primary">
											<input type="radio" name="options" id="optShortest" autocomplete="off"  ng-model="preference" value="shortest">K&uuml;rzeste
										</label>
										<label class="btn btn-primary">
											<input type="radio" name="options" id="optRecommended" autocomplete="off"  ng-model="preference" value="recommended">Empfohlene
										</label>
									</div>
									<!--
										<label>{{preference}}</label>
									-->

									<br />

									<label for="TODO">Startpunkt:</label>

									<br />

									<input id="startInput" type="text" onkeypress="isPositionAllowed(event)" value="{{startArray}}" size = "50%">

									<br />

									<br />

									<label for="TODO">Zielpunkt:</label>

									<br />

									<input id="goalInput" type="text" onkeypress="isPositionAllowed(event)" value="{{endArray}}" size = "50%">

									<br />

									<script>
										function isPositionAllowed(evt) {
											var code = (evt.keyCode ? evt.keyCode : evt.which);
											if (code == 8) { //Backspace key press
												return true;
											} else {
												var ch = String.fromCharCode(evt.which);
												if (!(/[0-9,.]/.test(ch))) {
													evt.preventDefault();
												}
											}
										}
									</script>

								<!-- </div> -->

							</div>

							<br />

							<div align="center">
								<input type="button" class="btn btn-s btn-info" value="Analyse starten!" ng-disabled="!pointSourceConfigured" ng-click="startAnalysis()"></input>
								<input type="button" class="btn btn-s btn-danger" value="Zur&uuml;cksetzen" ng-click="resetForm()"></input>
							</div>

							<div ng-show="error"
								class="alert alert-danger">
								<strong>Fehler</strong>
								Bei der Verarbeitung ist ein Fehler aufgetreten.
								<p></p>
									<strong>Fehlernachricht: </strong>
									<pre>{{error}}</pre>
							</div>

						</div>
						<!-- /.box-body -->

</div>
<!-- /.box -->


<div class="box box-danger" ng-show="currentIsochronesGeoJSON">
					<div class="box-header with-border">
						<h3 class="box-title">Ergebnisdarstellung</h3>

						<div class="box-tools pull-right">
							<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
							</button>
						</div>
					</div>
					<!-- /.box-header -->

					<div class="box-body">

						<div align="center">
							<div class="legend" align="left">
								<h4>Legende</h4>
								<label>Fortbewegungsart:
								</label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.transitMode}}
								<br />
								<div ng-show="focus === 'time'">
									<label>maximale Geschwindigkeit: </label>&nbsp; {{speedInKilometersPerHour}} km/h
									<br />
								</div>
								<label>Abbruchkriterium: </label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.reachMode}}
								<br />
								<label>Einheit: </label>&nbsp; {{$ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.cutOffUnit}}
								<br />
								<div ng-repeat="entry in $ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend.colorValueEntries">
									<i style="background: {{entry.color}}"></i> {{entry.value}}
								</div>
							</div>

							<br />
							<br />

							<div style="display: inline-block" align="center" id="reachabilityButtonSection">
								<button ng-click="removeReachabilityLayers()" type="button" class="btn btn-danger">Ergebnis verwerfen / Layer entfernen</button>
								<!-- another button to download as GeoJSOn will be set programatically within component file -->
							</div>
						</div>

					</div>
					<!-- /.box-body -->

</div>
<!-- /.box -->

</div>
