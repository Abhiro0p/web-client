<div class="just-padding">

	<br />
	<div class="btn-group btn-group-justified" data-toggle="buttons">
		<label class="btn btn-primary active" >
			<input type="radio" name="options" id="optBuffer" autocomplete="off" checked ng-change="changeType()"
				ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode" value="buffer"> <i class="far fa-dot-circle"></i> Puffer</input>
		</label>
		<label class="btn btn-primary" id="optFeetRadioButtonLabel">
			<input type="radio" name="options" id="optFeet" autocomplete="off" checked ng-change="changeType()"
				ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode" value="foot-walking"> <i class="fas fa-walking"></i> Fu&szlig;g&aumlnger
			</input>
		</label>
		<label class="btn btn-primary">
			<input type="radio" name="options" id="optBike" autocomplete="off" ng-change="changeType()"
				ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode" value="cycling-regular"> <i class="fas fa-biking"></i> Fahrrad </input>
		</label>
		<label class="btn btn-primary">
			<input type="radio" name="options" id="optCar" autocomplete="off" ng-change="changeType()"
				ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode" value="driving-car"> <i class="fas fa-car"></i> PKW </input>
		</label>
		<label class="btn btn-primary">
			<input type="radio" name="options" id="optWheelchair" autocomplete="off" ng-change="changeType()"
				ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode" value="wheelchair"> <i class="fab fa-accessible-icon"></i> Barrierefrei
			</input>
		</label>
	</div>

</div>

<div  class="ng-show" id="isochoneCalculation">

	<div class="just-padding">

		<!-- <label for="TODO">Analysefokus</label> -->

		<br />

		<div class="btn-group btn-group-justified" data-toggle="buttons">
			<label class="btn btn-primary active">
				<input type="radio" name="options" id="focus_distance" autocomplete="off" checked
					ng-change="changeFocus('distance')" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.focus" value="distance"> <i
					class="fas fa-ruler"></i> Distanz
			</label>
			<label class="btn btn-primary" ng-disabled="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.transitMode === 'buffer'">
				<input type="radio" name="options" id="focus_time" autocomplete="off" ng-change="changeFocus('time')"
					ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.focus" value="time"><i class="far fa-clock"></i> Zeit
			</label>
		</div>

		<!--
									<label>Fokus= {{$ctrl.kommonitorReachabilityHelperServiceInstance.settings.focus}}, Time= {{isTime}}</label>
								-->

		<br />
		<hr>
		<br />

		<div>


			<label>Allgemeine Hinweise</label>

			<p>je h&ouml;her die Anzahl der Startpunkte/Isochonen oder die Distanz/Zeit pro Isochrone, desto l&auml;nger
				dauert die Analyse</p>

			<br />

			<label>Isochronendefinition</label>
			<p>Geben Sie die gew&uuml;nschten Isochronengrenzen kommagetrennt ein
				(Beispiel: '100,200,300' in Metern oder '5,10,20' f&uuml;r Minuten).</p>
			<div>
				<input ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput" id="isochroneCutInput" type="text" style="width:95%;"
					placeholder="Isochronengrenzen angeben">
			</div>

			<br />
			<br />

			<div ng-if="!isTime">
				<label>Voreinstellungsoptionen</label>

				<br />

				<label class="radio-inline"><input type="radio" name="distances" value="100,200,300,400,500"
						ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput" ng-click="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput = '100,200,300,400,500'">
					100,200,300,400,500 Meter</label>

				<label class="radio-inline"><input type="radio" name="distances" value="500,1000,1500"
						ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput" ng-click="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput = '500,1000,1500'">
					500,1000,1500 Meter</label>

			</div>

			<div ng-if="isTime">
				<label>Voreinstellungsoptionen</label>

				<br />

				<label class="radio-inline"><input type="radio" name="times" value="5,10,15"
						ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput" ng-click="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput = '5,10,15'"> 5,10,15
					Minuten</label>

				<label class="radio-inline"><input type="radio" name="times" value="5,10,15,20,25"
						ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput"
						ng-click="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput = '5,10,15,20,25'">5,10,15,20,25 Minuten</label>

			</div>

			<!-- </div>
						</div>								 -->
			<!-- <br />
									<br /> -->

		</div>

		<br />

		<hr>
		<br />
		<div>

		</div>
		<div ng-show="!isUsedInReporting">
			<label for="TODO">Startpunkte</label>

			<br />

			<div class="btn-group btn-group-justified " data-toggle="buttons">
				<label class="btn btn-primary active">
					<input type="radio" name="options" id="startPointsSource_layer" autocomplete="off" checked
						ng-change="changeStartPointsSource_fromLayer()" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.startPointsSource"
						value="fromLayer"><i class="fas fa-layer-group"></i> aus Punkt-Layer</input>
				</label>
				<label id="reachability-draw-points-btn" class="btn btn-primary">
					<input type="radio" name="options" id="startPointsSource_draw" autocomplete="off"
						ng-change="changeStartPointsSource_manual()" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.startPointsSource"
						value="manual"><i class="fas fa-map-marked-alt"></i> Punkte zeichnen</input>
				</label>
			</div>

			<!--
										<label>Fokus= {{$ctrl.kommonitorReachabilityHelperServiceInstance.settings.focus}}, Time= {{isTime}}</label>
									-->

			<br />

			<div ng-show="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.startPointsSource === 'fromLayer'">

				<label>Art der Datumsdefinition zum Abruf eines Datensatzes</label>
				<div class="form-group">
					<label class="radio-inline"><input type="radio" name="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType"
							ng-value="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType_valueIndicator"
							ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType.selectedDateType"
							ng-change="!isUsedInReporting && $ctrl.kommonitorReachabilityHelperServiceInstance.fetchGeoJSONForIsochrones()">Datum des aktuellen
						Indikators</label>
					<label class="radio-inline"><input type="radio" name="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType"
							ng-value="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType_valueManual"
							ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType.selectedDateType">manuelles Datum
						<div ng-hide="!(settings.isochroneConfig.dateSelectionType.selectedDateType === $ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType_valueManual)"
							class="input-group date">
							<div class="input-group-addon">
								<i class="far fa-calendar-alt"></i>
							</div>
							<input type="text" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.selectedDate_manual"
								ng-change="onChangeManualDate_isochroneConfig()"
								ng-model-options="{debounce: 500, blur: 0}" class="form-control pull-right"
								placeholder="YYYY-MM-DD" id="manualDateDatepicker_reachabilityConfig" required>
						</div>
					</label>
					<label class="radio-inline"><input type="radio" name="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType"
							ng-value="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType_valuePerDataset"
							ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType.selectedDateType"
							ng-change="onClickPerDataset_isochroneConfig()">pro Datensatz</label>
				</div>

				<br />

				<div class="row vertical-align" style="margin-right:0px;">
					<div class="col-md-6 col-sm-6 col-xs-6">
						<div class="horizontal-align" ng-show="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer.geoJSON">
							<p><b>{{$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer.geoJSON.features.length}}</b> Startpunkte im
								selektierten Layer</p>
						</div>

						<div class="horizontal-align" ng-hide="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer">
							<p>noch kein Layer selektiert</p>
						</div>

						<div class="horizontal-align"
							ng-if="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer && ! $ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer.geoJSON">
							<p style="color: red;">zum angegebenen Zeitwert konnten keine validen Feature-Daten
								abgerufen werden</p>
						</div>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-6">
						<select style="font-size: 12px;" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer"
							ng-options="poi as poi.datasetName for poi in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterGeoresourcesByPoi() | filter:$ctrl.kommonitorDataExchangeServiceInstance.filterPois()"
							ng-change="onChangeSelectedStartPointLayer()" class="form-control" required>
							<option disabled selected value> -- Punkt-Layer w&auml;hlen -- </option>
						</select>

						<div
							ng-if="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer && $ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType.selectedDateType === $ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.dateSelectionType_valuePerDataset">
							<select style="font-size: 11px; width:135px; padding: 0px;"
								ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.selectedDate"
								ng-change="!isUsedInReporting && $ctrl.kommonitorReachabilityHelperServiceInstance.fetchGeoJSONForIsochrones()"
								ng-options="date as date.startDate for date in $ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
								ng-init="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneConfig.selectedDate = $ctrl.kommonitorReachabilityHelperServiceInstance.settings.selectedStartPointLayer.availablePeriodsOfValidity[settings.selectedStartPointLayer.availablePeriodsOfValidity.length - 1]"
								class="form-control" required>
							</select>
						</div>
					</div>
				</div>
			</div>

			<div ng-show="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.startPointsSource === 'manual'">

				<p>Zeichnen Sie selbst Punkte in die Karte. Dazu nutzen Sie bitte das Zeichen-Werkzeug
					in der unteren linken Ecke der Karte.</p>

				<div class="row vertical-align" style="margin-right:0px;">
					<div class="col-md-6 col-sm-6 col-xs-6">
						<div class="horizontal-align" ng-show="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.manualStartPoints.features.length > 0">
							<p><b>{{$ctrl.kommonitorReachabilityHelperServiceInstance.settings.manualStartPoints.features.length}}</b> Startpunkte gezeichnet</p>
						</div>

						<div class="horizontal-align" ng-hide="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.manualStartPoints.features.length > 0">
							<p>noch keine Start-Punkte gezeichnet</p>
						</div>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-6">
						<button type="button" class="btn btn-danger btn-sm" ng-click="removeAllDrawnPoints()">Punkte
							entfernen</button>
					</div>
				</div>
			</div>

			<br />
			<hr>
			<br />
		</div>

		<div align="center">

			<div >
				<b>Isochronen vereinigen</b> (erh&ouml;ht die Laufzeit der Berechnung)
				&nbsp;
				<label class="switch">
					<input type="checkbox" value="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.dissolveIsochrones" ng-model="$ctrl.kommonitorReachabilityHelperServiceInstance.settings.dissolveIsochrones"
						checked>
					<span class="switchslider round"></span>
				</label>
				<br />
				<br />
			</div>

			<input type="button" class="btn btn-s btn-info" value="Analyse starten!"
				ng-disabled="!($ctrl.kommonitorReachabilityHelperServiceInstance.settings.pointSourceConfigured && $ctrl.kommonitorReachabilityHelperServiceInstance.settings.isochroneInput)"
				ng-click="startAnalysis()"></input>
			<input type="button" class="btn btn-s btn-danger" value="Zur&uuml;cksetzen" ng-click="resetForm()"></input>
		</div>

		<div ng-show="!isUsedInReporting && $ctrl.kommonitorDataExchangeServiceInstance.isochroneLegend">
			<br />
			<br />
			<div style="display: inline-block" align="center" class="reachabilityIsochroneButtonSection">
				<button ng-click="removeReachabilityLayers()" type="button" class="btn btn-danger">Ergebnis
					verwerfen / Layer entfernen</button>
				<!-- another button to download as GeoJSOn will be set programatically within component file -->
			</div>
		</div>

	</div>

</div>

<div ng-show="error">
	<br />
	<div class="alert alert-danger">
		<strong>Fehler</strong>
		Bei der Verarbeitung ist ein Fehler aufgetreten.
		<p></p>
		<strong>Fehlernachricht: </strong>
		<pre>{{error}}</pre>
	</div>
</div>